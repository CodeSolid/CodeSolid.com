<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Is PyPy a Faster Version of Python? &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=19645805"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Is Python Free? Yes! We List the Best Free Tools" href="../is-python-free-with-list-of-tools/" />
    <link rel="prev" title="Simplicity is your Friend: PyCharm vs. VS Code for Teaching Programming" href="../simplicity-is-your-friend-python-vs-vs-code-for-teaching-software/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Added Recently:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-with-ollama/">Getting Started With Ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/yet-another-jdesmos-demo/">Yet Another JDesmos Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/desmos-jupyter/">Using Desmos Graphs in Jupyter Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Categories</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../category-math-and-math-software/">Math and Math Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-for-beginners-posts/">Python for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-functions/">Python Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-math-and-science/">Python Math and Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-practice/">Python Practice</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../category-python-tools/">Python Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../debugging-python-in-vs-code/">Debugging Python in VS Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-a-python-and-git-development-environment-on-windows-part-2/">Installing a Python and Git Development Environment on Windows, Part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pip-vs-conda-two-top-tools-for-managing-python-packages/">Pip vs. Conda: Two Top Tools for Managing Python Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-install-pip-and-conda-on-the-same-machine/">How To Install Pip and Conda on the Same Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-do-i-profile-python-code/">How To Profile Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-package-example-setuptools/">Python Package Example: Setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thonny-the-most-beginner-friendly-python-ide/">Thonny: The Most Beginner Friendly Python IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-a-python-development-environment-on-windows/">Installing a Python and Git Development Environment on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simplicity-is-your-friend-python-vs-vs-code-for-teaching-software/">Simplicity is your Friend:  PyCharm vs. VS Code for Teaching Programming</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Is PyPy a Faster Version of Python?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#other-python-implementations">Other Python Implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-simple-test-case">A Simple Test Case</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pypy-first-impressions-some-installation-issues">PyPy First Impressions: Some Installation Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evaluating-pypy-performance">Evaluating PyPy Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-final-thoughts">Some Final Thoughts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#you-may-also-like">You May Also Like</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../is-python-free-with-list-of-tools/">Is Python Free?  Yes!  We List the Best Free Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-configuration/">Python Configuration: Top Built-In and Third-Party Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pip-vs-pipenv-which-is-better-and-which-to-learn-first/">Pip vs Pipenv: Which is better and which to learn first?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pycharm-vs-vs-code/">PyCharm vs. VS Code: Which Is Better and Why?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../category-pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-miscellaneous/">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-learn-to-code/">Learn to Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../category-python-tools/">Python Tools</a></li>
      <li class="breadcrumb-item active">Is PyPy a Faster Version of Python?</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pypy-first-look-a-faster-version-of-python.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="is-pypy-a-faster-version-of-python">
<h1>Is PyPy a Faster Version of Python?<a class="headerlink" href="#is-pypy-a-faster-version-of-python" title="Link to this heading"></a></h1>
<p>Today I spent some time taking a look at PyPy. I had expected it to be much faster than the “standard” version of Python, also known as CPython. However, I also wanted to account for speed differences when it comes to NumPy, a commonly used Python library written in C.</p>
<p>PyPy is faster than CPython when comparing raw Python performance – roughly 3.5 times to 6 times faster in the tests we did. However, for operations using NumPy, PyPy can actually perform more slowly than CPython. Where Python integrates with NumPy, the results can even be more substantial.</p>
<section id="other-python-implementations">
<h2>Other Python Implementations<a class="headerlink" href="#other-python-implementations" title="Link to this heading"></a></h2>
<p>What most people mean when they think of Python is actually a specific implementation of Python, which is known as CPython. CPython is the reference implementation of Python, and it’s the most widely used version, but there are several other implementations available.</p>
<ul class="simple">
<li><p><strong>Jython</strong>. Jython was an early implementation of Python on the Java Virtual Machine (JVM). Jython currently lists 2.7.2 as the most recent version, and the last commit for many of the top level directories in the Jython repository took place several years ago. So I believe this is more of a historical curiosity at this point than a useful tool.</p></li>
<li><p><strong>IronPython</strong>. Of course, with Python running on the JVM, it was only a matter of time before someone would try to do the same thing on the .NET platform as well. IronPython does look like it has been more actively maintained than Jython, so it’s not so far behind. There’s currently an alpha version of Python 3.4 that came out in 2021 – but that’s still not modern. In the CPython world, 3.4 is already marked as <a class="reference external" href="https://www.python.org/downloads/release/python-3410/">End of Life</a>.</p></li>
<li><p><strong>Cython</strong>. In this discussion, Cython is a bit of an outlier, since it’s not really a different Python implementation. Instead, Cython is really CPython with a set of extensions for interfacing Python with C. It also features an optimizing compiler for compiling either standard Python code or – for even more of a performance boost – Python with Cython type declarations. In the latter case, the optimizing compiler can generate code that does not need to incur the overhead of dynamic types.</p></li>
<li><p><strong>Stackless Python.</strong> This was an attempt to add “microthreads” (called “tasklets” in Stackless Python). Tasklets wrap callable functions. On the face of it, this looks a lot like what CPython has done more recently with asyncio, but I’ve yet to find or investigate how these two really compare.</p></li>
<li><p><strong>MicroPython</strong>. This is a version of Python 3 that includes a subset of the standard library and is designed to run on constrained environments like microcontrollers.</p></li>
<li><p><strong>PyPy</strong>. Not to be confused with PyPi.org, the Python Package Index, PyPy is the name for an implementation of Python based on RPython, which was an attempt to provide generic support for building dynamic languages. The RPython site lists <a class="reference external" href="https://rpython.readthedocs.io/en/latest/examples.html">several other projects</a> based on this tool – but PyPy is probably the most famous offshoot in this breed.</p></li>
</ul>
<p>PyPy makes the claim that it is a faster version of Python than CPython, and that it’s highly compatible with it. In kicking the tires on PyPy, we set out not to exhaustively prove or disprove that claim one way or another, but simply to get a sense of how well it held up for some code to which we had ready access.</p>
</section>
<section id="a-simple-test-case">
<h2>A Simple Test Case<a class="headerlink" href="#a-simple-test-case" title="Link to this heading"></a></h2>
<p>To get an idea of how compatible PyPy was with CPython, I decided to take a project I had that – in fairness – was not exactly a huge benchmark or anything, but at least had a few packages including some minimal, C-based data science goodies in the mix. I made a copy of my Jupyter notebook and requirements.txt from the <a class="reference external" href="https://codesolid.com/python-lists-vs-arrays/">Python Lists versus Arrays</a> article I wrote recently.</p>
<p>In addition to relying on Jupyter and NumPy, which I thought would do at least a basic test of compatibility, this project already had several simple benchmarks coded up that I could run through PyPy to see how the performance compared.</p>
</section>
<section id="pypy-first-impressions-some-installation-issues">
<h2>PyPy First Impressions: Some Installation Issues<a class="headerlink" href="#pypy-first-impressions-some-installation-issues" title="Link to this heading"></a></h2>
<p>As I do now with most Python tools, I used PyEnv to see if there was a supported version of PyPy that I could install. At the time of this writing, the most recent version available is pypy3.8-7.3.7, so I installed and set it as a local version using pyenv:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyenv<span class="w"> </span>install<span class="w"> </span>pypy3.8-7.3.7
pyenv<span class="w"> </span><span class="nb">local</span><span class="w"> </span>pypy3.8-7.3.7
</pre></div>
</div>
<p>PyPy installed with no issues, and so I next created a virtual environment with it, activated it, and tried installing the requirements.txt I had from my article. At this point, I ran into a problem when building pyzmq (the Python client for zeromq). The solution I found was to change the C++ standard library being used in the build, as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CFLAGS</span><span class="o">=</span><span class="s2">&quot;--stdlib=libc++&quot;</span>
</pre></div>
</div>
<p>It’s unclear why CPython didn’t run into the same issue, but I confirmed that it had gotten through the zeromq build seamlessly without that fix.</p>
</section>
<section id="evaluating-pypy-performance">
<h2>Evaluating PyPy Performance<a class="headerlink" href="#evaluating-pypy-performance" title="Link to this heading"></a></h2>
<p>Once this was resolved, I decided to install Jupyter and NumPy independently of the earlier requirements.txt. At this point, I was able to re-run the benchmarks I ran in the Lists vs Arrays article. I won’t repeat much of the detailed code here since I already published it there, but here is a summary comparison.</p>
<table><tbody><tr><td>Benchmark</td><td>Time in CPython</td><td>Time in PyPy</td><td>Difference</td></tr><tr><td>10000 x 10000 numbers in list iterated</td><td>0.82558875</td><td>0.236211458</td><td>3.50 times faster</td></tr><tr><td>10000 x 10000 numbers in array iterated</td><td>1.369477958</td><td>0.228980292</td><td>5.98 times faster</td></tr><tr><td>Python sum on a list of 256,000 numbers</td><td>0.597</td><td>0.29</td><td>2.06 times faster</td></tr><tr><td>Python sum on a bytearray of 256,000 numbers</td><td>0.544</td><td>0.633</td><td>1.16 times slower</td></tr><tr><td>Python sum on numpy array 256,000 numbers</td><td>4.8544</td><td>74.7397</td><td>15.40 times slower</td></tr><tr><td>Numpy sum on numpy array 256,000 numbers</td><td>0.05</td><td>0.056</td><td>1.12 times slower</td></tr></tbody></table>
</section>
<section id="some-final-thoughts">
<h2>Some Final Thoughts<a class="headerlink" href="#some-final-thoughts" title="Link to this heading"></a></h2>
<p>This comparison of PyPy and CPython should be taking as a starting point only. It’s fair to point out that not only was it very limited in scope, the version of CPython I used was probably much more recent (though in fairness, I did pick what appeared to be the latest PyPy version in PyEnv as a basis for comparison). If you’re interested in a much more complete set of benchmarks, see the <a class="reference external" href="https://speed.python.org/about/">Python Speed Center</a>. However, I confess that even there, I don’t find the results to be compelling enough to move off of the reference implementation, CPython.</p>
<p>I did find the build issues that I ran into with PyPy to be a bit of an annoyance – all the more so because my test case was relatively simple. I’d be curious to see if any major projects are running on PyPy. My own feeling is that unless there’s a really compelling reason to move off of it, I would stick with either the reference implementation (CPython), or perhaps take the sort of mixed Python and C approach that Cython facilitates. While it’s fun to kick the tires on alternative implementations of Python, the benefits in the case of PyPy don’t seem to be worth the risks.</p>
</section>
<section id="you-may-also-like">
<h2>You May Also Like<a class="headerlink" href="#you-may-also-like" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://codesolid.com/learning-c-and-python-the-perfect-duo-for-success/">Learning C++ and Python: The Perfect Duo for Success</a></p>
<p><a class="reference external" href="https://codesolid.com/how-do-i-profile-python-code/">How to Profile Python Code</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../simplicity-is-your-friend-python-vs-vs-code-for-teaching-software/" class="btn btn-neutral float-left" title="Simplicity is your Friend: PyCharm vs. VS Code for Teaching Programming" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../is-python-free-with-list-of-tools/" class="btn btn-neutral float-right" title="Is Python Free? Yes! We List the Best Free Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>