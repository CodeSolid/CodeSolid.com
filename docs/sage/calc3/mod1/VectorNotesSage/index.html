

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with Vectors in Sage &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=19645805"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Added Recently:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../">Multivariable Calculus Sage Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../complex-inner-products/">The Inner Product of Complex Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting-started-with-ollama/">Getting Started With Ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../math/yet-another-jdesmos-demo/">Yet Another JDesmos Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../math/desmos-jupyter/">Using Desmos Graphs in Jupyter Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Categories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-math-and-math-software/">Math and Math Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-python-for-beginners-posts/">Python for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-python-functions/">Python Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-python-math-and-science/">Python Math and Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-python-practice/">Python Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-python-tools/">Python Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-miscellaneous/">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../category-learn-to-code/">Learn to Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Working with Vectors in Sage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/sage/calc3/mod1/VectorNotesSage.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-vectors-in-sage">
<h1>Working with Vectors in Sage<a class="headerlink" href="#working-with-vectors-in-sage" title="Link to this heading"></a></h1>
<section id="find-the-angle-and-radius-of-a-vector-in-component-form">
<h2>Find the angle and radius of a vector in component form.<a class="headerlink" href="#find-the-angle-and-radius-of-a-vector-in-component-form" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deg</span>
<span class="n">angle_rad</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">atan</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="n">angle_deg</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="n">angle_rad</span><span class="p">))</span>

<span class="c1"># Vector &lt;3,4&gt;, angle</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;For the position vector &lt;3,4&gt;, the angle with the x axis is </span><span class="si">{0:.2f}</span><span class="s2"> radians or </span><span class="si">{1:.2f}</span><span class="s2"> degrees&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">angle_rad</span><span class="p">,</span> <span class="n">angle_deg</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For the position vector &lt;3,4&gt;, the angle with the x axis is 0.93 radians or 53.13 degrees
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For the radius, simply use the pythagorean theorem: works for </span>

<span class="n">r</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The radius of the position vector &lt;3, 4&gt; is &quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The radius of the position vector &lt;3, 4&gt; is  5
</pre></div>
</div>
</div>
</div>
<p>Try a problem (Moer 11.1, Question 5)</p>
<p>Given a vector <span class="math notranslate nohighlight">\(\vec{u} = \langle 2, -2\rangle\)</span>, find the magnitude and the angle (in radians):</p>
<p>Magnitude is <span class="math notranslate nohighlight">\(\sqrt{2^2 + 2^2} = \sqrt{8} = 2 \sqrt{2}\)</span>  <span class="math notranslate nohighlight">\(\tan\theta = \frac{b}{a} = \tan-\frac{2}{2}\)</span></p>
<p>Angle = <span class="math notranslate nohighlight">\(\frac{7pi}{4}\)</span></p>
<p>And Moer says we’re good!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># No help!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">atan</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># plot it -- better!</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/4*pi
</pre></div>
</div>
<img alt="../../../../_images/48102d2a706a42119d6f97dd93e6b5e279e53c1ac835dbfaa307061ef7efe376.png" src="../../../../_images/48102d2a706a42119d6f97dd93e6b5e279e53c1ac835dbfaa307061ef7efe376.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="from-polar-form-to-component-form">
<h1>From “polar form to component form<a class="headerlink" href="#from-polar-form-to-component-form" title="Link to this heading"></a></h1>
<p>Given a vector <span class="math notranslate nohighlight">\(\vec{v}\)</span> with an magnititude <span class="math notranslate nohighlight">\(\|\vec{v}\|\)</span> making an angle <span class="math notranslate nohighlight">\(\theta\)</span> with the positive x axis, then:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\boldsymbol{\vec{v} = \langle\|\vec{v}\|\cos\theta, |\vec{v}\|\sin\theta\rangle = |\vec{v}\| \langle\cos\theta, \sin\theta\rangle}
\end{align}
\]</div>
<p>Here let’s work a problem with that, Moer #11.1, Question 4</p>
<p>A vector with magnitude 10 points in a direction 340 degrees counterclockwise from the positive x axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get degrees in radians:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">rad</span>
<span class="n">angle</span> <span class="o">=</span> <span class="n">rad</span><span class="p">(</span><span class="mi">340</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">horiz</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">N</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">vert</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">N</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Answer is &lt;</span><span class="si">{0}</span><span class="s2">, </span><span class="si">{1}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">horiz</span><span class="p">,</span> <span class="n">vert</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17/9*pi
Answer is &lt;9.4, -3.42&gt;
</pre></div>
</div>
</div>
</div>
<p>Check if it makes sense visually (spoiler alert, Moer marked it correct).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">vector</span><span class="p">((</span><span class="n">horiz</span><span class="p">,</span> <span class="n">vert</span><span class="p">)))</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">12</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/b9a42a22646e3fbbe44f1076488815f5bab3f533f8b86e84fabaf9ed8bbd25c2.png" src="../../../../_images/b9a42a22646e3fbbe44f1076488815f5bab3f533f8b86e84fabaf9ed8bbd25c2.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="finding-unit-vector-in-a-given-direction">
<h1>Finding unit vector in a given direction<a class="headerlink" href="#finding-unit-vector-in-a-given-direction" title="Link to this heading"></a></h1>
<p>Given a vector <span class="math notranslate nohighlight">\(\vec{v} = \langle u,v \rangle\)</span></p>
<ol class="arabic simple">
<li><p>Find the magnitiude, <span class="math notranslate nohighlight">\(\|\vec{v}\|\)</span></p></li>
<li><p>Then find our new vector with scalar multiplication: vector <span class="math notranslate nohighlight">\(\vec{u} =  \frac{1}{\|\vec{v}\|} \cdot \vec{v}\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do Moer 11.1 Q8:  </span>
<span class="c1"># Find the unit vector in the direction of &lt;−4, 2&gt;</span>
<span class="c1"># My answer differed from what I found by hand, but only because of </span>
<span class="c1"># Sage moving the radical to the numerator.</span>

<span class="n">v1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Terms:  &quot;</span><span class="p">,</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span>
<span class="n">inverse</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">magnitude</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inverse</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">inverse</span> <span class="o">*</span> <span class="n">v1</span>
<span class="n">v2</span>


<span class="c1"># Check magnitude of result:</span>
<span class="n">v2_mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v2_mag</span><span class="p">)</span>

<span class="c1"># Check answer done by hand</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">v3_mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">v3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v3_mag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Terms:   -4 2
2*sqrt(5)
1/10*sqrt(5)
1
1
</pre></div>
</div>
</div>
</div>
<section id="do-moer-11-1-q8-by-hand">
<h2>Do Moer 11.1 Q8 by hand<a class="headerlink" href="#do-moer-11-1-q8-by-hand" title="Link to this heading"></a></h2>
<p>Find the unit vector in the direction of &lt;−4, 2&gt;</p>
<p><span class="math notranslate nohighlight">\(\sqrt{20} = 2 \sqrt{5}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{1}{2 \sqrt{5}} \cdot -4 = \frac{-2}{\sqrt{5}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{1}{2 \sqrt{5}} \cdot 2 = \frac{1}{\sqrt{5}}\)</span></p>
<p>So the unit vecor is as shown below:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\langle - \frac{2}{\sqrt{5}}. \frac{1}{\sqrt{5}} \rangle
\end{align}
\]</div>
</section>
<section id="instantiating-vectors-in-sage-finding-dot-product-and-cross-product">
<h2>Instantiating vectors in Sage, finding dot product and cross product.<a class="headerlink" href="#instantiating-vectors-in-sage-finding-dot-product-and-cross-product" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># Can instantiate using tuple or list, among other iterables.</span>
<span class="n">V10</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="n">V11</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V10</span> <span class="o">==</span> <span class="n">V11</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dot product of V1 and V10: &quot;</span><span class="p">,</span> <span class="n">V1</span> <span class="o">*</span> <span class="n">V10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cross product of V1 and V10: &quot;</span><span class="p">,</span> <span class="n">V1</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">V10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
Dot product of V1 and V10:  26
Cross product of V1 and V10:  (8, -4, 0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets get a simple plot going:</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">origin</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">V1</span><span class="p">)</span> <span class="o">+</span> <span class="n">plot</span><span class="p">(</span><span class="n">V2</span><span class="p">)</span> <span class="o">+</span> <span class="n">origin</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">zmin</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;], &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: true, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:0.0, &quot;y&quot;:0.0, &quot;z&quot;:0.0}, {&quot;x&quot;:2.0, &quot;y&quot;:2.0, &quot;z&quot;:4.0}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 30.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}, {&quot;x&quot;: 0.9848350148430511, &quot;y&quot;: 1.9537390693039487, &quot;z&quot;: 2.9236458939131325}, {&quot;x&quot;: 0.9751536231308308, &quot;y&quot;: 1.9603072462616615, &quot;z&quot;: 2.9224942398453972}, {&quot;x&quot;: 0.9822327648830154, &quot;y&quot;: 1.9446196547764318, &quot;z&quot;: 2.9305929202514887}, {&quot;x&quot;: 0.9709430942482699, &quot;y&quot;: 1.9455517235986397, &quot;z&quot;: 2.9337347645815988}, {&quot;x&quot;: 0.9665679440342413, &quot;y&quot;: 1.955247188338135, &quot;z&quot;: 2.9287295048266113}, {&quot;x&quot;: 0.008888526615169437, &quot;y&quot;: 0.0018460928481852752, &quot;z&quot;: -0.004193570770513328}, {&quot;x&quot;: -0.0007928650970509072, &quot;y&quot;: 0.008414269805898185, &quot;z&quot;: -0.005345224838248487}, {&quot;x&quot;: 0.006286276655133676, &quot;y&quot;: -0.007273321679331586, &quot;z&quot;: 0.002753455567843164}, {&quot;x&quot;: -0.005003393979611823, &quot;y&quot;: -0.006341252857123658, &quot;z&quot;: 0.005895299897953045}, {&quot;x&quot;: -0.00937854419364038, &quot;y&quot;: 0.0033542118823717826, &quot;z&quot;: 0.000890040142965605}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.9999999999999999, &quot;y&quot;: 1.9999999999999998, &quot;z&quot;: 3.0}, {&quot;x&quot;: 1.0026120680733899, &quot;y&quot;: 1.9574312550003192, &quot;z&quot;: 2.9152587523721056}, {&quot;x&quot;: 0.973567892936729, &quot;y&quot;: 1.977135785873458, &quot;z&quot;: 2.9118037901689}, {&quot;x&quot;: 0.9948053181932827, &quot;y&quot;: 1.9300730114177687, &quot;z&quot;: 2.936099831387175}, {&quot;x&quot;: 0.9609363062890461, &quot;y&quot;: 1.9328692178843923, &quot;z&quot;: 2.9455253643775046}, {&quot;x&quot;: 0.9478108556469605, &quot;y&quot;: 1.9619556121028787, &quot;z&quot;: 2.9305095851125422}, {&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9682572844885244, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: 3.9152482987682475}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.01, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9650080875261955, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9168728972494122}, {&quot;x&quot;: 1.9544934652838128, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9221302083706036}, {&quot;x&quot;: 1.9512442683214837, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 3.923754806851768}, {&quot;x&quot;: 0.0085065080835204, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: -0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.01, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.005257311121191337, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: -0.002628655560595669}, {&quot;x&quot;: -0.005257311121191335, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 0.002628655560595668}, {&quot;x&quot;: -0.0085065080835204, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.0000000000000004, &quot;y&quot;: 0.0, &quot;z&quot;: 4.0}, {&quot;x&quot;: 1.9852703006555654, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 3.9067417906847273}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.03, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9755227097685781, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 3.911615586128221}, {&quot;x&quot;: 1.9439788430414302, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 3.927387519491795}, {&quot;x&quot;: 1.934231252154443, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 3.9322613149352885}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#6666ff&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we asked Gemini to refine it to exclude the box but get our standard axis lines showing:</span>

<span class="c1"># 1. Define your vectors and origin</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">origin_point</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># Corrected to 3D</span>

<span class="c1"># 2. Create the plots for your vectors</span>
<span class="n">plot_v1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;V1 = [1, 2, 3]&#39;</span><span class="p">)</span>
<span class="n">plot_v2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;V2 = [2, 0, 4]&#39;</span><span class="p">)</span>

<span class="c1"># 3. Define and plot the axes manually</span>
<span class="n">axis_len</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># How long to draw the axes</span>
<span class="n">label_offset</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># How far to put the label from the arrowhead</span>

<span class="c1"># Create arrows for X, Y, Z axes</span>
<span class="n">x_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">axis_len</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">z_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Create 3D text labels for the axes</span>
<span class="n">x_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">z_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># 4. Combine all the plot objects</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">plot_v1</span> <span class="o">+</span> <span class="n">plot_v2</span> <span class="o">+</span> <span class="n">origin_point</span> <span class="o">+</span> <span class="n">x_axis</span> <span class="o">+</span> <span class="n">y_axis</span> <span class="o">+</span> <span class="n">z_axis</span> <span class="o">+</span> <span class="n">x_label</span> <span class="o">+</span> <span class="n">y_label</span> <span class="o">+</span> <span class="n">z_label</span>

<span class="c1"># 5. Show the final plot</span>
<span class="c1">#    The key is frame=False</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: false, &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: false, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:-0.08774351209636412, &quot;y&quot;:-0.08108719811121771, &quot;z&quot;:-0.0899999999999997}, {&quot;x&quot;:5.3, &quot;y&quot;:5.3, &quot;z&quot;:5.3}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [{&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;x&quot;, &quot;x&quot;: 5.3, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;y&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 5.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;z&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 5.3}];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 30.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}, {&quot;x&quot;: 0.9848350148430511, &quot;y&quot;: 1.9537390693039487, &quot;z&quot;: 2.9236458939131325}, {&quot;x&quot;: 0.9751536231308308, &quot;y&quot;: 1.9603072462616615, &quot;z&quot;: 2.9224942398453972}, {&quot;x&quot;: 0.9822327648830154, &quot;y&quot;: 1.9446196547764318, &quot;z&quot;: 2.9305929202514887}, {&quot;x&quot;: 0.9709430942482699, &quot;y&quot;: 1.9455517235986397, &quot;z&quot;: 2.9337347645815988}, {&quot;x&quot;: 0.9665679440342413, &quot;y&quot;: 1.955247188338135, &quot;z&quot;: 2.9287295048266113}, {&quot;x&quot;: 0.008888526615169437, &quot;y&quot;: 0.0018460928481852752, &quot;z&quot;: -0.004193570770513328}, {&quot;x&quot;: -0.0007928650970509072, &quot;y&quot;: 0.008414269805898185, &quot;z&quot;: -0.005345224838248487}, {&quot;x&quot;: 0.006286276655133676, &quot;y&quot;: -0.007273321679331586, &quot;z&quot;: 0.002753455567843164}, {&quot;x&quot;: -0.005003393979611823, &quot;y&quot;: -0.006341252857123658, &quot;z&quot;: 0.005895299897953045}, {&quot;x&quot;: -0.00937854419364038, &quot;y&quot;: 0.0033542118823717826, &quot;z&quot;: 0.000890040142965605}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.9999999999999999, &quot;y&quot;: 1.9999999999999998, &quot;z&quot;: 3.0}, {&quot;x&quot;: 1.0026120680733899, &quot;y&quot;: 1.9574312550003192, &quot;z&quot;: 2.9152587523721056}, {&quot;x&quot;: 0.973567892936729, &quot;y&quot;: 1.977135785873458, &quot;z&quot;: 2.9118037901689}, {&quot;x&quot;: 0.9948053181932827, &quot;y&quot;: 1.9300730114177687, &quot;z&quot;: 2.936099831387175}, {&quot;x&quot;: 0.9609363062890461, &quot;y&quot;: 1.9328692178843923, &quot;z&quot;: 2.9455253643775046}, {&quot;x&quot;: 0.9478108556469605, &quot;y&quot;: 1.9619556121028787, &quot;z&quot;: 2.9305095851125422}, {&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9682572844885244, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: 3.9152482987682475}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.01, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9650080875261955, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9168728972494122}, {&quot;x&quot;: 1.9544934652838128, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9221302083706036}, {&quot;x&quot;: 1.9512442683214837, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 3.923754806851768}, {&quot;x&quot;: 0.0085065080835204, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: -0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.01, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.005257311121191337, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: -0.002628655560595669}, {&quot;x&quot;: -0.005257311121191335, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 0.002628655560595668}, {&quot;x&quot;: -0.0085065080835204, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.0000000000000004, &quot;y&quot;: 0.0, &quot;z&quot;: 4.0}, {&quot;x&quot;: 1.9852703006555654, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 3.9067417906847273}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.03, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9755227097685781, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 3.911615586128221}, {&quot;x&quot;: 1.9439788430414302, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 3.927387519491795}, {&quot;x&quot;: 1.934231252154443, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 3.9322613149352885}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 4.73, &quot;y&quot;: 0.0, &quot;z&quot;: 2.8962896799834905e-16}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: -0.028531695488854317}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.03, &quot;z&quot;: 2.8962896799834905e-16}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: -0.017633557568773908}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 0.017633557568774477}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 0.028531695488854897}, {&quot;x&quot;: 1.7470624777336386e-18, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: -0.028531695488854605}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.03, &quot;z&quot;: 0.0}, {&quot;x&quot;: 1.079743991708995e-18, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: -0.017633557568774196}, {&quot;x&quot;: -1.0797439917089947e-18, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 0.01763355756877419}, {&quot;x&quot;: -1.7470624777336386e-18, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 0.02853169548885461}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 5.0, &quot;y&quot;: 0.0, &quot;z&quot;: 3.061616997868383e-16}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.05611408216728602, &quot;z&quot;: -0.0703648334221224}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.09, &quot;z&quot;: 2.8962896799834905e-16}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.02002688405606829, &quot;z&quot;: -0.08774351209636383}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.08108719811121771, &quot;z&quot;: -0.03904953652057995}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.08108719811121771, &quot;z&quot;: 0.03904953652058051}, {&quot;x&quot;: 4.73, &quot;y&quot;: -0.02002688405606831, &quot;z&quot;: 0.08774351209636441}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.056114082167286, &quot;z&quot;: 0.07036483342212298}, {&quot;x&quot;: 4.73, &quot;y&quot;: 0.0, &quot;z&quot;: 2.8962896799834905e-16}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 7, 6], [0, 2, 7], [2, 1, 8], [1, 3, 8], [3, 4, 8], [4, 5, 8], [5, 6, 8], [6, 7, 8], [7, 2, 8]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 4.73, &quot;z&quot;: 2.8962896799834905e-16}, {&quot;x&quot;: 0.028531695488854605, &quot;y&quot;: 4.73, &quot;z&quot;: -0.009270509831248134}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.73, &quot;z&quot;: -0.02999999999999971}, {&quot;x&quot;: 0.017633557568774196, &quot;y&quot;: 4.73, &quot;z&quot;: 0.024270509831248708}, {&quot;x&quot;: -0.01763355756877419, &quot;y&quot;: 4.73, &quot;z&quot;: 0.02427050983124871}, {&quot;x&quot;: -0.02853169548885461, &quot;y&quot;: 4.73, &quot;z&quot;: -0.009270509831248127}, {&quot;x&quot;: 0.028531695488854605, &quot;y&quot;: 5.676550095651226e-19, &quot;z&quot;: -0.009270509831248424}, {&quot;x&quot;: 0.0, &quot;y&quot;: 1.8369701987210296e-18, &quot;z&quot;: -0.03}, {&quot;x&quot;: 0.017633557568774196, &quot;y&quot;: -1.4861401089256373e-18, &quot;z&quot;: 0.02427050983124842}, {&quot;x&quot;: -0.01763355756877419, &quot;y&quot;: -1.4861401089256375e-18, &quot;z&quot;: 0.024270509831248423}, {&quot;x&quot;: -0.02853169548885461, &quot;y&quot;: 5.676550095651222e-19, &quot;z&quot;: -0.009270509831248417}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 5.0, &quot;z&quot;: 3.061616997868383e-16}, {&quot;x&quot;: 0.07036483342212269, &quot;y&quot;: 4.73, &quot;z&quot;: -0.05611408216728573}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.73, &quot;z&quot;: -0.0899999999999997}, {&quot;x&quot;: 0.08774351209636412, &quot;y&quot;: 4.73, &quot;z&quot;: 0.02002688405606858}, {&quot;x&quot;: 0.03904953652058024, &quot;y&quot;: 4.73, &quot;z&quot;: 0.081087198111218}, {&quot;x&quot;: -0.03904953652058022, &quot;y&quot;: 4.73, &quot;z&quot;: 0.081087198111218}, {&quot;x&quot;: -0.08774351209636412, &quot;y&quot;: 4.73, &quot;z&quot;: 0.0200268840560686}, {&quot;x&quot;: -0.07036483342212269, &quot;y&quot;: 4.73, &quot;z&quot;: -0.05611408216728571}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.73, &quot;z&quot;: 2.8962896799834905e-16}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 7, 6], [0, 2, 7], [2, 1, 8], [1, 3, 8], [3, 4, 8], [4, 5, 8], [5, 6, 8], [6, 7, 8], [7, 2, 8]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.028531695488854605, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.03, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.017633557568774196, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 4.73}, {&quot;x&quot;: -0.01763355756877419, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 4.73}, {&quot;x&quot;: -0.02853169548885461, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.028531695488854605, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.03, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.017633557568774196, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 0.0}, {&quot;x&quot;: -0.01763355756877419, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 0.0}, {&quot;x&quot;: -0.02853169548885461, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 5.0}, {&quot;x&quot;: 0.07036483342212269, &quot;y&quot;: 0.05611408216728602, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.09, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.08774351209636412, &quot;y&quot;: -0.02002688405606829, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.03904953652058024, &quot;y&quot;: -0.08108719811121771, &quot;z&quot;: 4.73}, {&quot;x&quot;: -0.03904953652058022, &quot;y&quot;: -0.08108719811121771, &quot;z&quot;: 4.73}, {&quot;x&quot;: -0.08774351209636412, &quot;y&quot;: -0.02002688405606831, &quot;z&quot;: 4.73}, {&quot;x&quot;: -0.07036483342212269, &quot;y&quot;: 0.056114082167286, &quot;z&quot;: 4.73}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 4.73}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 7, 6], [0, 2, 7], [2, 1, 8], [1, 3, 8], [3, 4, 8], [4, 5, 8], [5, 6, 8], [6, 7, 8], [7, 2, 8]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Or refinied again:</span>
<span class="c1"># 1. Define your vectors</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">origin_point</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># 2. Calculate vector lengths for labels</span>
<span class="n">len_v1</span> <span class="o">=</span> <span class="n">V1</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Get numerical approximation</span>
<span class="n">len_v2</span> <span class="o">=</span> <span class="n">V2</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># 3. Create vector plots (now with thickness and new labels)</span>
<span class="n">plot_v1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">V1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
               <span class="n">legend_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V1 = [1, 2, 3] (Length: </span><span class="si">{</span><span class="n">len_v1</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plot_v2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
               <span class="n">legend_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;V2 = [2, 0, 4] (Length: </span><span class="si">{</span><span class="n">len_v2</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># 4. Define and plot the axes</span>
<span class="n">axis_len</span> <span class="o">=</span> <span class="mi">5</span>       <span class="c1"># How long to draw the axes</span>
<span class="n">label_offset</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># How far to put the &#39;x, y, z&#39; label</span>

<span class="n">x_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">axis_len</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">y_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">z_axis</span> <span class="o">=</span> <span class="n">arrow</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">z_label</span> <span class="o">=</span> <span class="n">text3d</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="n">label_offset</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># 5. --- NEW: Add ticks and number labels ---</span>
<span class="n">tick_offset</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># How far to put number labels from the axis</span>
<span class="n">tick_size</span> <span class="o">=</span> <span class="mi">15</span>     <span class="c1"># Size of the tick mark points</span>

<span class="c1"># Use sum() to create a single plot object from a generator</span>
<span class="n">x_ticks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">point</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">tick_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_ticks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">tick_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">z_ticks</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">tick_size</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">x_tick_labels</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">text3d</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">tick_offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">y_tick_labels</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">text3d</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">tick_offset</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">z_tick_labels</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">text3d</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tick_offset</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>


<span class="c1"># 6. Combine ALL the plot objects</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">plot_v1</span> <span class="o">+</span> <span class="n">plot_v2</span> <span class="o">+</span> <span class="n">origin_point</span>
<span class="n">pl</span> <span class="o">+=</span> <span class="n">x_axis</span> <span class="o">+</span> <span class="n">y_axis</span> <span class="o">+</span> <span class="n">z_axis</span> <span class="o">+</span> <span class="n">x_label</span> <span class="o">+</span> <span class="n">y_label</span> <span class="o">+</span> <span class="n">z_label</span>
<span class="n">pl</span> <span class="o">+=</span> <span class="n">x_ticks</span> <span class="o">+</span> <span class="n">y_ticks</span> <span class="o">+</span> <span class="n">z_ticks</span>
<span class="n">pl</span> <span class="o">+=</span> <span class="n">x_tick_labels</span> <span class="o">+</span> <span class="n">y_tick_labels</span> <span class="o">+</span> <span class="n">z_tick_labels</span>

<span class="c1"># 7. Show the final plot</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: false, &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: false, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:-0.05706339097770922, &quot;y&quot;:-0.3, &quot;z&quot;:-0.0599999999999997}, {&quot;x&quot;:5.3, &quot;y&quot;:5.3, &quot;z&quot;:5.3}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [{&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;x&quot;, &quot;x&quot;: 5.3, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;y&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 5.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 14.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;z&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 5.3}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;1&quot;, &quot;x&quot;: 1.0, &quot;y&quot;: -0.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;2&quot;, &quot;x&quot;: 2.0, &quot;y&quot;: -0.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;3&quot;, &quot;x&quot;: 3.0, &quot;y&quot;: -0.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;4&quot;, &quot;x&quot;: 4.0, &quot;y&quot;: -0.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;5&quot;, &quot;x&quot;: 5.0, &quot;y&quot;: -0.3, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;1&quot;, &quot;x&quot;: 0.3, &quot;y&quot;: 1.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;2&quot;, &quot;x&quot;: 0.3, &quot;y&quot;: 2.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;3&quot;, &quot;x&quot;: 0.3, &quot;y&quot;: 3.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;4&quot;, &quot;x&quot;: 0.3, &quot;y&quot;: 4.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;5&quot;, &quot;x&quot;: 0.3, &quot;y&quot;: 5.0, &quot;z&quot;: 0.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;1&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.3, &quot;z&quot;: 1.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;2&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.3, &quot;z&quot;: 2.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;3&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.3, &quot;z&quot;: 3.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;4&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.3, &quot;z&quot;: 4.0}, {&quot;color&quot;: &quot;#000000&quot;, &quot;fontSize&quot;: 10.0, &quot;fontFamily&quot;: [&quot;monospace&quot;], &quot;fontStyle&quot;: &quot;normal&quot;, &quot;fontWeight&quot;: &quot;normal&quot;, &quot;opacity&quot;: 1.0, &quot;text&quot;: &quot;5&quot;, &quot;x&quot;: 0.0, &quot;y&quot;: 0.3, &quot;z&quot;: 5.0}];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 30.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [1.0, 0.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [2.0, 0.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [3.0, 0.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [4.0, 0.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [5.0, 0.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 1.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 2.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 3.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 4.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 5.0, 0.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 0.0, 1.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 0.0, 2.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 0.0, 3.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 0.0, 4.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;point&quot;: [0.0, 0.0, 5.0], &quot;size&quot;: 15.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}, {&quot;x&quot;: 0.9848350148430511, &quot;y&quot;: 1.9537390693039487, &quot;z&quot;: 2.9236458939131325}, {&quot;x&quot;: 0.9751536231308308, &quot;y&quot;: 1.9603072462616615, &quot;z&quot;: 2.9224942398453972}, {&quot;x&quot;: 0.9822327648830154, &quot;y&quot;: 1.9446196547764318, &quot;z&quot;: 2.9305929202514887}, {&quot;x&quot;: 0.9709430942482699, &quot;y&quot;: 1.9455517235986397, &quot;z&quot;: 2.9337347645815988}, {&quot;x&quot;: 0.9665679440342413, &quot;y&quot;: 1.955247188338135, &quot;z&quot;: 2.9287295048266113}, {&quot;x&quot;: 0.008888526615169437, &quot;y&quot;: 0.0018460928481852752, &quot;z&quot;: -0.004193570770513328}, {&quot;x&quot;: -0.0007928650970509072, &quot;y&quot;: 0.008414269805898185, &quot;z&quot;: -0.005345224838248487}, {&quot;x&quot;: 0.006286276655133676, &quot;y&quot;: -0.007273321679331586, &quot;z&quot;: 0.002753455567843164}, {&quot;x&quot;: -0.005003393979611823, &quot;y&quot;: -0.006341252857123658, &quot;z&quot;: 0.005895299897953045}, {&quot;x&quot;: -0.00937854419364038, &quot;y&quot;: 0.0033542118823717826, &quot;z&quot;: 0.000890040142965605}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.9999999999999999, &quot;y&quot;: 1.9999999999999998, &quot;z&quot;: 3.0}, {&quot;x&quot;: 1.0026120680733899, &quot;y&quot;: 1.9574312550003192, &quot;z&quot;: 2.9152587523721056}, {&quot;x&quot;: 0.973567892936729, &quot;y&quot;: 1.977135785873458, &quot;z&quot;: 2.9118037901689}, {&quot;x&quot;: 0.9948053181932827, &quot;y&quot;: 1.9300730114177687, &quot;z&quot;: 2.936099831387175}, {&quot;x&quot;: 0.9609363062890461, &quot;y&quot;: 1.9328692178843923, &quot;z&quot;: 2.9455253643775046}, {&quot;x&quot;: 0.9478108556469605, &quot;y&quot;: 1.9619556121028787, &quot;z&quot;: 2.9305095851125422}, {&quot;x&quot;: 0.9759464882278817, &quot;y&quot;: 1.9518929764557633, &quot;z&quot;: 2.9278394646836454}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9682572844885244, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: 3.9152482987682475}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.01, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9650080875261955, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9168728972494122}, {&quot;x&quot;: 1.9544934652838128, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 3.9221302083706036}, {&quot;x&quot;: 1.9512442683214837, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 3.923754806851768}, {&quot;x&quot;: 0.0085065080835204, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: -0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.01, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.005257311121191337, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: -0.002628655560595669}, {&quot;x&quot;: -0.005257311121191335, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 0.002628655560595668}, {&quot;x&quot;: -0.0085065080835204, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 0.0042532540417602}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.0000000000000004, &quot;y&quot;: 0.0, &quot;z&quot;: 4.0}, {&quot;x&quot;: 1.9852703006555654, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 3.9067417906847273}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.03, &quot;z&quot;: 3.919501552810008}, {&quot;x&quot;: 1.9755227097685781, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 3.911615586128221}, {&quot;x&quot;: 1.9439788430414302, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 3.927387519491795}, {&quot;x&quot;: 1.934231252154443, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 3.9322613149352885}, {&quot;x&quot;: 1.9597507764050042, &quot;y&quot;: 0.0, &quot;z&quot;: 3.919501552810008}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 4.82, &quot;y&quot;: 0.0, &quot;z&quot;: 2.9513987859451214e-16}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.006180339887498949, &quot;z&quot;: -0.019021130325902778}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.02, &quot;z&quot;: 2.9513987859451214e-16}, {&quot;x&quot;: 4.82, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: -0.01175570504584917}, {&quot;x&quot;: 4.82, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 0.011755705045849756}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.006180339887498945, &quot;z&quot;: 0.019021130325903367}, {&quot;x&quot;: 1.1647083184890924e-18, &quot;y&quot;: 0.006180339887498949, &quot;z&quot;: -0.019021130325903073}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.02, &quot;z&quot;: 0.0}, {&quot;x&quot;: 7.198293278059968e-19, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: -0.011755705045849465}, {&quot;x&quot;: -7.198293278059966e-19, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 0.011755705045849461}, {&quot;x&quot;: -1.1647083184890924e-18, &quot;y&quot;: 0.006180339887498945, &quot;z&quot;: 0.019021130325903073}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 5.0, &quot;y&quot;: 0.0, &quot;z&quot;: 3.061616997868383e-16}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.018541019662496848, &quot;z&quot;: -0.05706339097770891}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.06, &quot;z&quot;: 2.9513987859451214e-16}, {&quot;x&quot;: 4.82, &quot;y&quot;: -0.04854101966249684, &quot;z&quot;: -0.03526711513754809}, {&quot;x&quot;: 4.82, &quot;y&quot;: -0.04854101966249685, &quot;z&quot;: 0.035267115137548675}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.018541019662496834, &quot;z&quot;: 0.057063390977709516}, {&quot;x&quot;: 4.82, &quot;y&quot;: 0.0, &quot;z&quot;: 2.9513987859451214e-16}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 4.82, &quot;z&quot;: 2.9513987859451214e-16}, {&quot;x&quot;: 0.019021130325903073, &quot;y&quot;: 4.82, &quot;z&quot;: -0.006180339887498654}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.82, &quot;z&quot;: -0.019999999999999706}, {&quot;x&quot;: 0.011755705045849465, &quot;y&quot;: 4.82, &quot;z&quot;: 0.016180339887499243}, {&quot;x&quot;: -0.011755705045849461, &quot;y&quot;: 4.82, &quot;z&quot;: 0.016180339887499243}, {&quot;x&quot;: -0.019021130325903073, &quot;y&quot;: 4.82, &quot;z&quot;: -0.00618033988749865}, {&quot;x&quot;: 0.019021130325903073, &quot;y&quot;: 3.7843667304341507e-19, &quot;z&quot;: -0.006180339887498949}, {&quot;x&quot;: 0.0, &quot;y&quot;: 1.2246467991473532e-18, &quot;z&quot;: -0.02}, {&quot;x&quot;: 0.011755705045849465, &quot;y&quot;: -9.907600726170915e-19, &quot;z&quot;: 0.016180339887498948}, {&quot;x&quot;: -0.011755705045849461, &quot;y&quot;: -9.907600726170915e-19, &quot;z&quot;: 0.016180339887498948}, {&quot;x&quot;: -0.019021130325903073, &quot;y&quot;: 3.784366730434148e-19, &quot;z&quot;: -0.006180339887498945}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 5.0, &quot;z&quot;: 3.061616997868383e-16}, {&quot;x&quot;: 0.05706339097770921, &quot;y&quot;: 4.82, &quot;z&quot;: -0.018541019662496553}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.82, &quot;z&quot;: -0.0599999999999997}, {&quot;x&quot;: 0.03526711513754839, &quot;y&quot;: 4.82, &quot;z&quot;: 0.04854101966249714}, {&quot;x&quot;: -0.03526711513754838, &quot;y&quot;: 4.82, &quot;z&quot;: 0.048541019662497145}, {&quot;x&quot;: -0.05706339097770922, &quot;y&quot;: 4.82, &quot;z&quot;: -0.01854101966249654}, {&quot;x&quot;: 0.0, &quot;y&quot;: 4.82, &quot;z&quot;: 2.9513987859451214e-16}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.019021130325903073, &quot;y&quot;: 0.006180339887498949, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.02, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.011755705045849465, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 4.82}, {&quot;x&quot;: -0.011755705045849461, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 4.82}, {&quot;x&quot;: -0.019021130325903073, &quot;y&quot;: 0.006180339887498945, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.019021130325903073, &quot;y&quot;: 0.006180339887498949, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.02, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.011755705045849465, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 0.0}, {&quot;x&quot;: -0.011755705045849461, &quot;y&quot;: -0.016180339887498948, &quot;z&quot;: 0.0}, {&quot;x&quot;: -0.019021130325903073, &quot;y&quot;: 0.006180339887498945, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 5.0}, {&quot;x&quot;: 0.05706339097770921, &quot;y&quot;: 0.018541019662496848, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.06, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.03526711513754839, &quot;y&quot;: -0.04854101966249684, &quot;z&quot;: 4.82}, {&quot;x&quot;: -0.03526711513754838, &quot;y&quot;: -0.04854101966249685, &quot;z&quot;: 4.82}, {&quot;x&quot;: -0.05706339097770922, &quot;y&quot;: 0.018541019662496834, &quot;z&quot;: 4.82}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 4.82}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Another example (thanks to Gemini):</span>

<span class="c1"># 1. Define vectors</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># 2. Create plot objects for each vector</span>
<span class="n">p_v1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;v1 = (3, 4)&#39;</span><span class="p">)</span>
<span class="n">p_v2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;v2 = (-2, 2)&#39;</span><span class="p">)</span>

<span class="c1"># 3. Add an origin point</span>
<span class="n">origin</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># 4. Combine and show</span>
<span class="c1"># (aspect_ratio=1 ensures x and y axes are scaled equally)</span>
<span class="p">(</span><span class="n">p_v1</span> <span class="o">+</span> <span class="n">p_v2</span> <span class="o">+</span> <span class="n">origin</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/5b8835f01ba8e8e4c241d7b2ccd1a4b958ce36a76ee451b926abc11babf6a884.png" src="../../../../_images/5b8835f01ba8e8e4c241d7b2ccd1a4b958ce36a76ee451b926abc11babf6a884.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solve a problem, 11.1 q9 -- enterered rounded answers in Moer, it&#39;s correct!</span>
<span class="c1"># A person starts walking from home and walks:</span>
<span class="c1"># 4 miles East</span>
<span class="c1"># 5 miles Southeast</span>
<span class="c1"># 4 miles South</span>
<span class="c1"># 3 miles Southwest</span>
<span class="c1"># 3 miles East</span>
<span class="c1"># Have to find total miles (easy) and displacement vector and ||displacement vector||</span>

<span class="n">southeast</span> <span class="o">=</span> <span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
<span class="n">southwest</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>

<span class="c1"># Solve # 11.1 q 9:</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">N</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">southeast</span><span class="p">)),</span> <span class="n">N</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">southeast</span><span class="p">))])</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">v4</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">N</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">southwest</span><span class="p">)),</span> <span class="n">N</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">southwest</span><span class="p">))])</span>
<span class="n">v5</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">displacement</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span> <span class="o">+</span> <span class="n">v3</span> <span class="o">+</span> <span class="n">v4</span> <span class="o">+</span> <span class="n">v5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">displacement</span><span class="p">)</span>
<span class="n">sqrt</span><span class="p">(</span><span class="n">displacement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">displacement</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8.41421356237310, -9.65685424949238)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.8083497715031
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.65685424949238
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\vec{v} = \langle-1,2\rangle\quad\quad\vec{u} = \langle1,1\rangle\quad\quad \vec{u} + \vec{v} = \langle0, 3\rangle\)</span></p>
<p><span class="math notranslate nohighlight">\(\vec{w} = \langle6, -3\rangle\)</span></p>
<p>If a and b are scalars, then <span class="math notranslate nohighlight">\(a\vec{u} + b\vec{v} = \vec{w}\)</span></p>
<p>So <span class="math notranslate nohighlight">\(a \cdot \langle1,1\rangle + b\cdot \langle-1,2\rangle = \langle6, -3\rangle\)</span></p>
<p>So system of equations to solve is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
a - b &amp;= 6 \\
a + 2b &amp;= -3
\\
\therefore
\\
a &amp;= b + 6 \\
b + 6 + 2b &amp;= -3\\
3b &amp;= -9\\
b&amp;=\boxed{-3} \\
a&amp;=\boxed{3}
\end{alignat*}
\end{split}\]</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="magnitude-distance-midpoints">
<h1>Magnitude, Distance, Midpoints<a class="headerlink" href="#magnitude-distance-midpoints" title="Link to this heading"></a></h1>
<p>Note that the distance formula between two points (x,y,z) and <span class="math notranslate nohighlight">\((x_1, y_1, z_1)\)</span>
is effectively the same as the magnitude formula, i.e.,</p>
<p><span class="math notranslate nohighlight">\(\sqrt{(x - x_1)^2 + (y - y_1)^2 + (z - z_1)^2}\)</span></p>
<p>The midpoint formula for the two points would be:</p>
<p><span class="math notranslate nohighlight">\(\langle \frac{x+x_1}{2}, \frac{y+y_1}{2}, \frac{z+z_1}{2}\rangle\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">magnitude_list</span><span class="p">(</span><span class="n">l</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return the Euclidean length of a point specified as a list of scalars&quot;&quot;&quot;</span>
    <span class="n">square_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">square_sum</span> <span class="o">+=</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">square_sum</span><span class="p">)</span>

<span class="c1"># But see the vector.norm() method, which will give you the same thing!</span>

<span class="k">def</span><span class="w"> </span><span class="nf">magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">vector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return the Euclidean length of a vector&quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">magnitude_list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="c1"># Note we could also implement distance between two points </span>
<span class="c1"># doing the subtraction in that fn and calling magnitude_list</span>
<span class="c1"># from sympy import Point3D</span>
<span class="c1"># p = Point3D([1,2,3])</span>
<span class="c1"># print(p)</span>

<span class="n">V</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">==</span> <span class="n">V</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="implicit-plots-of-3d-surfaces">
<h2>Implicit Plots of 3D Surfaces<a class="headerlink" href="#implicit-plots-of-3d-surfaces" title="Link to this heading"></a></h2>
<p>For implicit plotting, we used https://c3d.libretexts.org/CalcPlot3D/index.html, selecting “implicit surface” from the dropdown.  This is easier to set up than SageMath.</p>
<p>The cell below is commented out because it throws off Jupyter’s scrolling somewhat</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># x = var(&#39;x&#39;)</span>
<span class="c1"># y = var(&#39;y&#39;)</span>
<span class="c1"># z = var(&#39;z&#39;)</span>

<span class="c1"># equation = (x-2)**2 + y**2 + z**2 == 36</span>
<span class="c1"># implicit_plot3d(equation, (x,-8, 8), (y,-8,8), (z,-8, 8))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking a solution gotten by hand:</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">a</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-1, 11, -6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking a solution gotten by hand:</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12, -18, -4)
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-dot-product">
<h2>The Dot Product<a class="headerlink" href="#the-dot-product" title="Link to this heading"></a></h2>
<p>The dot product gives us information about the angle <span class="math notranslate nohighlight">\(\theta\)</span> between two vectors.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
&amp;\vec{V1} \cdot \vec{V2} = 0 &amp;\quad\quad \theta = \frac{pi}{2} \\
&amp;\vec{V1} \cdot \vec{V2} \gt 0 &amp;\quad\quad \theta \lt \frac{pi}{2} \\
&amp;\vec{V1} \cdot \vec{V2} \lt 0 &amp;\quad\quad \theta \gt \frac{pi}{2} \\
\end{alignat*}
\end{split}\]</div>
<p>The dot product is related to the angle as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\vec{v} \cdot \vec{w} &amp;= \|\vec{v}\| \|\vec{w}\| \cos \theta \\ \\
\cos \theta &amp;= \frac{\vec{v} \cdot \vec{w}}{\|\vec{v}\| \|\vec{w}\|}
\end{align*}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">(</span><span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mi">35</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">13</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.89902877949431
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">26</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<span class="n">lhs</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-35
sqrt(26)
5*sqrt(2)
5.09901951359278
5.09901951359279
-7/52*sqrt(26)*sqrt(2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">52</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">13</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.970725343394151
-0.970725343394151
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deg</span>
<span class="n">theta_radians</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="o">-</span><span class="mf">0.970725343394151</span><span class="p">)</span>
<span class="n">theta_degrees</span> <span class="o">=</span> <span class="p">(</span><span class="n">acos</span><span class="p">(</span><span class="n">deg</span><span class="p">(</span><span class="o">-</span><span class="mf">0.970725343394151</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">theta_radians</span><span class="p">,</span> <span class="s2">&quot; approx =  &quot;</span><span class="p">,</span> <span class="n">theta_degrees</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.89902877949431  approx =   arccos(-174.730561810947/pi)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">origin</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">plot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">origin</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;&gt;
&lt;style&gt;

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

&lt;/style&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  if ( !window.THREE ) document.write(&#x27; \
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;&gt;&lt;\/script&gt; \
            &#x27;);
&lt;/script&gt;
        
&lt;script&gt;

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;], &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: true, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === &#x27;dark&#x27; )
        document.body.className = &#x27;dark-theme&#x27;;

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === &#x27;dark&#x27; ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:-5.0, &quot;y&quot;:-1.0, &quot;z&quot;:-3.0}, {&quot;x&quot;:4.0, &quot;y&quot;:0.0, &quot;z&quot;:5.0}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange &gt; autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange &gt; autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange &gt; autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + &#x27;=&#x27; + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + &#x27;=&#x27; + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + &#x27;=&#x27; + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || &#x27;black&#x27;;
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || &#x27;monospace&#x27;;
        var fontStyle = style.fontStyle || &#x27;normal&#x27;;
        var fontWeight = style.fontWeight || &#x27;normal&#x27;;
        var opacity = style.opacity || 1;

        if ( options.theme === &#x27;dark&#x27; )
            if ( color === &#x27;black&#x27; || color === &#x27;#000000&#x27; )
                color = &#x27;white&#x27;;

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? &#x27;&quot;&#x27; + f + &#x27;&quot;&#x27; : f;
            }).join(&#x27;, &#x27;);
        }

        var canvas = document.createElement( &#x27;canvas&#x27; );
        var context = canvas.getContext( &#x27;2d&#x27; );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + &#x27;px&#x27;, fontFamily].join(&#x27; &#x27;);

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas&#x27;s underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + &#x27;px&#x27;;
        canvas.style.height = height + &#x27;px&#x27;;

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = &#x27;center&#x27;;
        context.textBaseline = &#x27;middle&#x27;;
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity &lt; 1 ) {
            // Setting opacity=1 would cause the texture&#x27;s alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === &#x27;orthographic&#x27; ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === &#x27;orthographic&#x27; ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box&#x27;s diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect &gt; 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i &lt; lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === &#x27;camera&#x27; ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( &#x27;change&#x27;, function() { if ( !animate ) render(); } );

    window.addEventListener( &#x27;resize&#x27;, function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [];
    for ( var i=0 ; i &lt; texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [{&quot;point&quot;: [0.0, 0.0, 0.0], &quot;size&quot;: 30.0, &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( &#x27;canvas&#x27; );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( &#x27;2d&#x27; );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity &lt; 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [];
    for ( var i=0 ; i &lt; lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity &lt; 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth &gt; 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 3.9293981913502534, &quot;y&quot;: -0.9823495478375633, &quot;z&quot;: -2.9470486435126904}, {&quot;x&quot;: 3.9258461453268407, &quot;y&quot;: -0.9759937250972228, &quot;z&quot;: -2.9539033124573537}, {&quot;x&quot;: 3.9331354817159347, &quot;y&quot;: -0.9732838704289837, &quot;z&quot;: -2.9450874821613087}, {&quot;x&quot;: 3.9234656158124994, &quot;y&quot;: -0.9874871107661432, &quot;z&quot;: -2.9532462232535024}, {&quot;x&quot;: 3.9292837040505075, &quot;y&quot;: -0.9918805590871075, &quot;z&quot;: -2.944024289495837}, {&quot;x&quot;: 3.9352600098454844, &quot;y&quot;: -0.9831024738083595, &quot;z&quot;: -2.9389819101954506}, {&quot;x&quot;: -0.003552046023412369, &quot;y&quot;: 0.00635582274034045, &quot;z&quot;: -0.006854668944663308}, {&quot;x&quot;: 0.003737290365681299, &quot;y&quot;: 0.009065677408579675, &quot;z&quot;: 0.00196116135138184}, {&quot;x&quot;: -0.005932575537754049, &quot;y&quot;: -0.005137562928579778, &quot;z&quot;: -0.006197579740812137}, {&quot;x&quot;: -0.0001144872997458178, &quot;y&quot;: -0.0095310112495442, &quot;z&quot;: 0.003024354016853643}, {&quot;x&quot;: 0.005861818495230935, &quot;y&quot;: -0.0007529259707961455, &quot;z&quot;: 0.008066733317239961}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 3.9999999999999996, &quot;y&quot;: -0.9999999999999999, &quot;z&quot;: -3.0}, {&quot;x&quot;: 3.9187420532800163, &quot;y&quot;: -0.963282079616542, &quot;z&quot;: -2.9676126503466804}, {&quot;x&quot;: 3.940610062447297, &quot;y&quot;: -0.9551525156118243, &quot;z&quot;: -2.941165159458545}, {&quot;x&quot;: 3.911600464736991, &quot;y&quot;: -0.9977622366233027, &quot;z&quot;: -2.965641382735127}, {&quot;x&quot;: 3.929054729451016, &quot;y&quot;: -1.0109425815861959, &quot;z&quot;: -2.9379755814621293}, {&quot;x&quot;: 3.946983646835946, &quot;y&quot;: -0.9846083257499518, &quot;z&quot;: -2.9228484435609703}, {&quot;x&quot;: 3.9293981913502534, &quot;y&quot;: -0.9823495478375633, &quot;z&quot;: -2.9470486435126904}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: -4.936360389693212, &quot;y&quot;: 0.0, &quot;z&quot;: 4.936360389693211}, {&quot;x&quot;: -4.929635404573572, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: 4.94308537481285}, {&quot;x&quot;: -4.936360389693212, &quot;y&quot;: 0.01, &quot;z&quot;: 4.936360389693211}, {&quot;x&quot;: -4.932204120315437, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 4.940516659070985}, {&quot;x&quot;: -4.940516659070986, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 4.932204120315436}, {&quot;x&quot;: -4.943085374812851, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: 4.929635404573571}, {&quot;x&quot;: 0.006724985119639573, &quot;y&quot;: 0.0030901699437494747, &quot;z&quot;: 0.0067249851196395745}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.01, &quot;z&quot;: 0.0}, {&quot;x&quot;: 0.0041562693777745345, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: 0.004156269377774535}, {&quot;x&quot;: -0.004156269377774534, &quot;y&quot;: -0.008090169943749474, &quot;z&quot;: -0.0041562693777745345}, {&quot;x&quot;: -0.006724985119639573, &quot;y&quot;: 0.0030901699437494725, &quot;z&quot;: -0.0067249851196395745}, {&quot;x&quot;: 0.0, &quot;y&quot;: 0.0, &quot;z&quot;: 0.0}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6, 7], [1, 3, 8, 6], [3, 4, 9, 8], [4, 5, 10, 9], [5, 2, 7, 10], [7, 6, 11], [6, 8, 11], [8, 9, 11], [9, 10, 11], [10, 7, 11]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: -5.000000000000001, &quot;y&quot;: 0.0, &quot;z&quot;: 5.0}, {&quot;x&quot;: -4.916185434334293, &quot;y&quot;: 0.009270509831248424, &quot;z&quot;: 4.95653534505213}, {&quot;x&quot;: -4.936360389693212, &quot;y&quot;: 0.03, &quot;z&quot;: 4.936360389693211}, {&quot;x&quot;: -4.923891581559888, &quot;y&quot;: -0.02427050983124842, &quot;z&quot;: 4.948829197826535}, {&quot;x&quot;: -4.9488291978265355, &quot;y&quot;: -0.024270509831248423, &quot;z&quot;: 4.923891581559887}, {&quot;x&quot;: -4.956535345052131, &quot;y&quot;: 0.009270509831248417, &quot;z&quot;: 4.916185434334292}, {&quot;x&quot;: -4.936360389693212, &quot;y&quot;: 0.0, &quot;z&quot;: 4.936360389693211}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 2, 5], [2, 1, 6], [1, 3, 6], [3, 4, 6], [4, 5, 6], [5, 2, 6]], &quot;color&quot;: &quot;#0000ff&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i &lt; surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = &#x27;faceColors&#x27; in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i &lt; json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity &lt; 1 ? true : false;
        var depthWrite = &#x27;depthWrite&#x27; in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? &#x27;white&#x27; : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i &lt; json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j &lt; f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] &lt; f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === &#x27;dark&#x27; ? &#x27;white&#x27; : &#x27;black&#x27;;
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth &gt; 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( &#x27;menu-content&#x27; );
        if ( m.style.display === &#x27;block&#x27; ) m.style.display = &#x27;none&#x27;
        else m.style.display = &#x27;block&#x27;;

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = renderer.domElement.toDataURL( &#x27;image/png&#x27; );
        a.download = &#x27;screenshot&#x27;;
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ &#x27;&lt;!DOCTYPE html&gt;\n&#x27; + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( &#x27;a&#x27; ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return &#x27;graphic.html&#x27;;
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + &#x27;.html&#x27;;
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( &#x27;textarea&#x27; );
        textArea.textContent = JSON.stringify( axis ) + &#x27;,&#x27; + angle;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Viewpoint copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement(&#x27;textarea&#x27;);
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = &#x27;,camera_position=&#x27; + cam_position;
        textArea.style.csstext = &#x27;position: absolute; top: -100%&#x27;;
        document.body.append( textArea );
        textArea.select();
        document.execCommand( &#x27;copy&#x27; );

        var m = document.getElementById( &#x27;menu-message&#x27; );
        m.innerHTML = &#x27;Camera position &#x27;+ cam_position+&#x27; copied to clipboard&#x27;;
        m.style.display = &#x27;block&#x27;;
        setTimeout( function() { m.style.display = &#x27;none&#x27;; }, 2000 );

    }

&lt;/script&gt;

&lt;div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;&gt;&amp;#x24d8;
&lt;div id=&quot;menu-message&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;menu-content&quot;&gt;
&lt;div onclick=&quot;saveAsPNG()&quot;&gt;Save as PNG&lt;/div&gt;
&lt;div onclick=&quot;saveAsHTML()&quot;&gt;Save as HTML&lt;/div&gt;
&lt;div onclick=&quot;getCamera()&quot;&gt;Get camera&lt;/div&gt;
&lt;div onclick=&quot;getViewpoint()&quot;&gt;Get viewpoint&lt;/div&gt;
&lt;div&gt;Close Menu&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;
"
        width="100%"
        height="400"
        style="border: 0;">
</iframe>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checking an answer.  Are these two vectors orthogonal?</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="projection-of-vectors">
<h2>Projection of vectors<a class="headerlink" href="#projection-of-vectors" title="Link to this heading"></a></h2>
<p>A vector projection is a kind of “shadow that one vector casts onto another.  When we want to find the projection of <span class="math notranslate nohighlight">\(\vec{b}\)</span> onto <span class="math notranslate nohighlight">\(\vec{a}\)</span>, we write it as <span class="math notranslate nohighlight">\(\text{proj}_{\vec{a}}{\vec{b}}\)</span>.</p>
<p>Here is the formula to use:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\boldsymbol{
\text{proj}_{\vec{w}}\vec{v} = \left( \frac{\vec{v}\cdot\vec{w}}{\|\vec{w}\|^2} \right) 
\vec{w}}
\end{align}
\]</div>
<p>The following problem, (11.4 Question 6), finds the projection <span class="math notranslate nohighlight">\(\vec{b}\)</span> onto <span class="math notranslate nohighlight">\(\vec{a}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">vector</span> <span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_projection_b_onto_a</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;project b onto a&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span>

<span class="n">get_projection_b_onto_a</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(72/17, 0, -18/17)
</pre></div>
</div>
</div>
</div>
<p>11.4 question 7.
Find the angle of intersection, in radians, of two functions that intersect at (-2,3).</p>
<p>The functions are <span class="math notranslate nohighlight">\(f(x) = x^2 + 2x + 3\)</span> and <span class="math notranslate nohighlight">\(g(x) = -5x - 7\)</span></p>
<p>First, we need to find the derivatives, to get our slopes as something we can represent as vectors.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
f^{\prime}(x) = 2x + 2 \\
g^{\prime}(x) = -5
\end{align}
\end{split}\]</div>
<p>Find the slope of tangent line for <span class="math notranslate nohighlight">\(f(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
(y - 3) = -2(x - (-2)) \\
y - 3 = -2x -4 \\
y = -2x - 1 \\
\end{align}
\end{split}\]</div>
<p>The slope is -2 at <span class="math notranslate nohighlight">\(f(x)\)</span> = -2.  (For confirmation, see https://www.desmos.com/calculator/5ftj0x5ccz)</p>
<p><span class="math notranslate nohighlight">\(g(x)\)</span> is linear, so the slope is -5 wherever you go.</p>
<p>Next, per the video, we need to create two vectors, lets call them <span class="math notranslate nohighlight">\(\vec{F}\)</span> and <span class="math notranslate nohighlight">\(\vec{G}\)</span>  We can read these off the graph.</p>
<p>For <span class="math notranslate nohighlight">\(\vec{F}\)</span>, we can take (-2,3) to the point (0,-1).  Subtracting we have the position vector, (-2,4)</p>
<p>For vector <span class="math notranslate nohighlight">\(\vec{G}\)</span>, we can take the points (-2,3) to the points (0, -7).  Subtracting we get a position vector (-2, 10).</p>
<p>Next, as we documented above, we’ll need to use the formula below to find the angle begween the vectors.</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
\cos \theta &amp;= \frac{\vec{v} \cdot \vec{w}}{\|\vec{v}\| \|\vec{w}\|}
\end{align}
\]</div>
<p>Earlier, however, we didn’t stop to implement that formula in Sage.  Let’s do so now, and use it to find our angle between our two vectors, <span class="math notranslate nohighlight">\(\vec{F} = (-2,4)\)</span> and <span class="math notranslate nohighlight">\(\vec{G} = (-2,10)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_angle_between_vectors</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">vector</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="n">vector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;returns the angle between two vectors in radians.&quot;&quot;&quot;</span>
    <span class="n">cos_theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">w</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">acos</span><span class="p">(</span><span class="n">cos_theta</span><span class="p">)</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Raw angle:  &quot;</span><span class="p">,</span> <span class="n">get_angle_between_vectors</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluated:  &quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">(</span><span class="n">get_angle_between_vectors</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In degree:  &quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">(</span><span class="n">deg</span><span class="p">((</span><span class="n">get_angle_between_vectors</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Raw angle:   arccos(11/130*sqrt(26)*sqrt(5))
Evaluated:   0.266252049150925
In degree:   15.2551187030578
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-vector-cross-products">
<h2>3D Vector Cross Products<a class="headerlink" href="#d-vector-cross-products" title="Link to this heading"></a></h2>
<p>Earlier we used the <code class="docutils literal notranslate"><span class="pre">vector.cross_product</span></code> method in Sage to find a cross-product.  Let’s review how to do it without sage.</p>
<p>There is an unmemorizable formula for the vector cross-product, but fortunately, we can also think about it in terms of the determinant of a 3x3 matrix based on a and b.  We use the regular multiplication symbol for the cross-product:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{a} \times \vec{b} = \det{\begin{vmatrix}
i &amp; j &amp; k \\
a_1 &amp; a_2 &amp; a_3 \\
b_1 &amp; b_2 &amp; b_3 \\
\end{vmatrix}}
= &amp;\left(\det{\begin{vmatrix}
a_2 &amp; a_3 \\
b_2 &amp; b_3 \\
\end{vmatrix}} \cdot i\right)  - \left(\det{\begin{vmatrix}
a_1 &amp; a_3 \\
b_1 &amp; b_3 \\
\end{vmatrix}} \cdot j\right) + 
\left(\det{\begin{vmatrix}
a_1 &amp; a_2 \\
b_1 &amp; b_2 \\
\end{vmatrix}}
\cdot k\right)\\ 
\end{align}
\end{split}\]</div>
<p>The first thirty-eight minutes or so of <a class="reference external" href="https://www.youtube.com/watch?v=qqfhgStQ-cA">this video</a> provides a good treatment of the details of how we got that formula in terms of three 2x2 matrices.</p>
<p>Let’s use this method to solve 11.5, question 3, which asks us to find the cross-product <span class="math notranslate nohighlight">\(\vec{u} \times \vec{b}\)</span> where:</p>
<p><span class="math notranslate nohighlight">\(\vec{u} = 6i + 9j + 6k\)</span></p>
<p><span class="math notranslate nohighlight">\(\vec{v} = \langle4, -8, 5\rangle\)</span></p>
<p>Solving for</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\det{\begin{vmatrix}
i &amp; j &amp; k \\
6 &amp; 9 &amp; 6 \\
4 &amp; -8 &amp; 5\\
\end{vmatrix}}
\end{align}
\end{split}\]</div>
<p>gives us:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
&amp; [(45) - (-48)]i - [(30)-(24)]j + [(-48) -(36)]k \\
\\
= &amp;\;\boxed{\langle 93, -6, -84\rangle}
\end{align}
\end{split}\]</div>
<p>Now, since doing this manually is error-prone as heck, let’s check our result using Sage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">u</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(93, -6, -84)
</pre></div>
</div>
</div>
</div>
<p>Sure enough, I had a sign error in the middle term, since corrected.</p>
</section>
<section id="some-properties-of-the-cross-product">
<h2>Some Properties of the Cross Product<a class="headerlink" href="#some-properties-of-the-cross-product" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>The cross product is a vector that is orthogonal to both of the original two vectors.  Since they are orthogonal, the dot product will be zero.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="c1"># Show w is orthogonal to both u and v</span>
<span class="k">assert</span> <span class="n">w</span> <span class="o">*</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">w</span> <span class="o">*</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>If we consider two vectors as forming two sides of a parallelogram, then the magnitude of the cross product is equal to the area of this parallelogram.  If theta is the angle between them, then we may find this area using the <a class="reference external" href="https://en.wikipedia.org/wiki/Parallelogram">parallelogram area formula</a></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\begin{align}
|\vec{A}\times\vec{B}| = |\vec{A}| \cdot |\vec{B}| \cdot \sin\theta
\end{align}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show that a cross product represents the </span>
<span class="c1"># area of a parallelogram between two vectors.</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="c1"># get_angle_between_vectors defined earlier in this notebook.</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">get_angle_between_vectors</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="nb">print</span><span class="p">((</span><span class="n">u</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">.</span><span class="n">simplify</span><span class="p">())</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="n">u</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9*sqrt(101)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9*sqrt(101)
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>The cross product is “anti-commutative”.  That is, if we reverse the order of the vectors, we get the negation of the cross-product.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span> <span class="n">v</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">z</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.34846922834953
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>

<span class="n">PQ</span> <span class="o">=</span> <span class="n">Q</span><span class="o">-</span><span class="n">P</span>
<span class="n">PR</span> <span class="o">=</span> <span class="n">R</span><span class="o">-</span><span class="n">P</span>

<span class="p">(</span><span class="n">PQ</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">PR</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sqrt(673)
</pre></div>
</div>
</div>
</div>
<p>PQ = &lt;(-6 -3), (6-4), (-4 -(-4)&gt; = &lt;-9, 4, 0&gt;
PR = &lt;(0 - 3), (-2 -2), (-2) - (-4)&gt; = &lt;-3, -4, 2&gt;</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pq</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">pq</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.8693797647189
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="triple-scalar-product">
<h1>Triple Scalar Product<a class="headerlink" href="#triple-scalar-product" title="Link to this heading"></a></h1>
<p>This is used to find the volume of a parallepiped (a lopsided cube, i.e., a paralellogram in 3D).</p>
<p>Formally we use <span class="math notranslate nohighlight">\(V = | u \cdot (v \times w)|\)</span> (That’s an abslolute value – result will be scalar)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
u \cdot (v \times w) = \begin{vmatrix}
u_1 &amp; u_2 &amp; u3 \\
v_1 &amp; v_2 &amp; v_3 \\
w_1 &amp; w_2 &amp; w_3
\end{vmatrix}
\end{align}
\end{split}\]</div>
<p>So you’d work it like a 3D determinant cross product.  (The order doesn’t matter of the three terms).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-9
</pre></div>
</div>
</div>
</div>
<section id="finding-the-equation-of-a-plane-given-3-points">
<h2>Finding the equation of a plane given 3 points<a class="headerlink" href="#finding-the-equation-of-a-plane-given-3-points" title="Link to this heading"></a></h2>
<p>11.6 Q 4.  “Find a plane through the points (-8,-5,3), (-4,6,1), (3,4,-2)”</p>
<p>We need to find a normal vector to the plane as a first step.  Let’s call these vectors, a, b &amp; c, respectively.  Then:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

<span class="n">bc</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span> <span class="n">b</span>
<span class="n">ba</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>

<span class="n">normal_vector</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">bc</span><span class="p">)</span>
<span class="n">normal_vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(37.0000000000000, 2.00000000000000, 85.0000000000000)
</pre></div>
</div>
</div>
</div>
<p>Next, we use the Point-Normal equation to find the equation of the plane.</p>
</section>
<section id="equation-of-a-plane-point-normal-form">
<h2>Equation of a Plane (Point - Normal Form)<a class="headerlink" href="#equation-of-a-plane-point-normal-form" title="Link to this heading"></a></h2>
<p>The plane containing the point <span class="math notranslate nohighlight">\((x_1, y_1, z_1)\)</span> and having a normal vector <span class="math notranslate nohighlight">\(\vec{n} = \langle a, b, c \rangle\)</span> has equation:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{a(x - x_1) + b(y - y_1) + c(z - z_1) = 0}\]</div>
<p>Or a, b, and c terms are given by the components of our normal vector.  Meanwhile, we can use any point in the plane as the terms of our <span class="math notranslate nohighlight">\(x_1, y_1, z_1\)</span>.  We’ll use point b.</p>
<p>Given that, our equation is <span class="math notranslate nohighlight">\(37(x - (-4)) + 2(y - 6) + 85(z - 1) = 0\)</span>, and simplifying we have <span class="math notranslate nohighlight">\(37(x +4) + 2(y - 6) + 85(z - 1) = 0\)</span></p>
<p><a class="reference external" href="https://www.desmos.com/3d/fm6wbveeqf">Checking it graphically on Desmos</a>, it is correct.</p>
</section>
<section id="finding-the-intersection-of-two-planes">
<h2>Finding the intersection of two planes:<a class="headerlink" href="#finding-the-intersection-of-two-planes" title="Link to this heading"></a></h2>
<p>In exercise 11.6 question 5, we’re asked to find the equation of a line where two planes intersect.  The planes are <span class="math notranslate nohighlight">\(-4y\ +\ 5z\ =\ -7\)</span> and <span class="math notranslate nohighlight">\(-9x\ -7y\ -4z\ =\ -25\)</span>, and they are <a class="reference external" href="https://www.desmos.com/3d/qcyywxvipn">graphed here</a>.  The <a class="reference external" href="https://moer.maricopa.edu/assessment/watchvid.php?url=http%3A%2F%2Fyoutu.be%2FPlcZDfKv2_Q">associated video</a> tells us to find the normal vector for each plane, and then the cross product of those two normal vectors will give us the direction vector of their intersection.  Then given a point on that vector, we can figure out the equation.</p>
<p>The Point-Normal equation from the last cell means we can read off our normal vector components from the coefficients of each term.  So we have two normal vectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\vec{n_1} &amp;= \langle0, -4, 5\rangle \\
\vec{n_2} &amp;= \langle-9, -7, -4\rangle
\end{align}
\end{split}\]</div>
<p>Their cross-product (see below), is <span class="math notranslate nohighlight">\(\langle51, -45, -36\rangle\)</span></p>
<p>Note we’re asked to find a parametric equation based on <span class="math notranslate nohighlight">\(x(t) = 51t\)</span>  Copying our point normal equation from above, we have:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{a(x - x_1) + b(y - y_1) + c(z - z_1) = 0}\]</div>
<p>So we want to find three points <span class="math notranslate nohighlight">\(P(0, , )\)</span>.  For points y and z, we have a system of equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
4y + 5z = -7 \\
-7y - 4z = -25
\end{align}
\end{split}\]</div>
<p>We solve it in a code cell below using Sage.  <span class="math notranslate nohighlight">\(y =3, z = 1\)</span></p>
<p>Multiplying row two by <span class="math notranslate nohighlight">\(\frac{5}{4}\)</span> gives <span class="math notranslate nohighlight">\(-\frac{35}{4}y - 5z = - \frac{125}{4}\)</span></p>
<p>Subtracting</p>
<p>So at this point we have a point, <span class="math notranslate nohighlight">\(P\)</span> on the line, and <span class="math notranslate nohighlight">\(P = \left(0, 3, 1\right)\)</span> and a direction vector, <span class="math notranslate nohighlight">\(\langle51, -45, -36\rangle\)</span></p>
<p>So we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
x &amp;= 0 + 51t \\
y &amp;= 3 -45t \\
z &amp;= 1 - 36t
\end{align}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the cross product for exercise below:</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n1</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">n2</span><span class="p">),</span> <span class="n">n2</span><span class="o">.</span><span class="n">cross_product</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(51, -45, -36) (-51, 45, 36)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use sage to solve the system of </span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">M</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">])</span>
<span class="n">M</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simplify</span><span class="p">(</span><span class="o">-</span><span class="mi">174</span><span class="o">/-</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87/10
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>