<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Understanding Python Types and Type Hints &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=19645805"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Added Recently:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started-with-ollama/">Getting Started With Ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/yet-another-jdesmos-demo/">Yet Another JDesmos Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/desmos-jupyter/">Using Desmos Graphs in Jupyter Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Categories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../category-math-and-math-software/">Math and Math Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-for-beginners-posts/">Python for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-functions/">Python Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-math-and-science/">Python Math and Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-practice/">Python Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-python-tools/">Python Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-miscellaneous/">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../category-learn-to-code/">Learn to Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Understanding Python Types and Type Hints</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/understanding-python-types-and-type-hints.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="understanding-python-types-and-type-hints">
<h1>Understanding Python Types and Type Hints<a class="headerlink" href="#understanding-python-types-and-type-hints" title="Link to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>One of Python’s beginner-friendly features is that newcomers don’t need to declare or think about data types very much, at least not at first. Variables are never declared. They pop into existence as if by magic when you first assign them.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Hello world.&quot;</span>
</pre></div>
</div>
<p>In Java, in contrast, one writes a variable declaration as follows, putting the type information right up front:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello world.&quot;</span><span class="p">;</span><span class="w"> </span>
</pre></div>
</div>
<p>The same “looseness” applies to function parameters and return values. In Java, these must be explicitly declared, and the compiler will complain if you don’t:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">greeting</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Hello &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>As you may know, we can do the same thing in Python without the explicit “String” type appearing either in the parameter list or the return value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greeting</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;!&quot;</span>
</pre></div>
</div>
<p>Although it is convenient both for newcomers to the language and for experienced programmers who want to fire off a quick-and-dirty Python script, this looseness has some disadvantages. We’ll discuss some of these and the solution to them.</p>
<p>In this article, we want to consider several aspects of Python’s type system. We’ll discuss some functions beginners should know for exploring Python types, before discussing a few of the many features of Python’s type hinting system and the typing module.</p>
<p>Before moving onto those topics, let’s begin by examining what happens when a variable is created and discussing the common misconception that Python is weakly typed.</p>
</section>
<section id="is-python-weakly-typed">
<h2>Is Python Weakly-Typed?<a class="headerlink" href="#is-python-weakly-typed" title="Link to this heading"></a></h2>
<section id="weakly-typed-vs-dynamically-typed">
<h3>Weakly Typed vs. Dynamically Typed<a class="headerlink" href="#weakly-typed-vs-dynamically-typed" title="Link to this heading"></a></h3>
<p>We saw above that we create Python variables by assigning them, not by declaring them. On the surface, this appears similar to the type inference supported in some languages like Rust and later versions of C# and Java. Unlike those languages, however, Python variable types are not yet fixed at that point for the length of the program.</p>
<p>If we ignore that bad practice of a poorly named and ambiguous variable for a moment, the following is a perfectly valid Python program:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">42</span>
Hello
</pre></div>
</div>
<p>Many folks will take the fact that variables don’t need to be explicitly declared to mean that Python is weakly typed. In the excellent book, Fluent Python, Luciano Ramalho sheds some light on this. Weakly typed languages like JavaScript are languages where type conversions are very common, as opposed to strongly typed ones, where they are rare.</p>
<p>The above code, in contrast, shows that Python is a dynamically typed language as opposed to one with static typing. As the name suggests, this distinction more precisely captures the fact that in Python, a type can change as the program runs.</p>
<p>No type conversion is taking place in the print call. What’s going on behind the scenes is that if the input to print is not a string, Python print will first try to convert it to one using a <a class="reference external" href="https://codesolid.com/dunder-methods-in-python-the-ugliest-awesome-sauce/">dunder method</a> on the object (actually it tries __str__() first, then __repr__()). Because of this, <code class="docutils literal notranslate"><span class="pre">print(42)</span></code> gives the same output as the more verbose call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">((</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>
</pre></div>
</div>
<p>Even if the type of an object can change at runtime, Python never loses sight of the type it contains at any given time. Contrast this with JavaScript, where because of type conversions a special operator, <code class="docutils literal notranslate"><span class="pre">===</span></code>, is used to compare objects while suppressing the type conversion. Without this crutch, in JavaScript:</p>
<p><img alt="Comparisons in JavaScript are not type-aware." src="../_images/image6.png" /></p>
<p>In Python, because the types are dynamic, the comparison is still allowed, but because the language is strongly typed, we get a more expected (or at least, more type-aware) answer:</p>
<p><img alt="Comparisons in Python are type-aware." src="../_images/image-214.png" /></p>
<p>Python, then, is dynamically typed, not weakly typed.</p>
</section>
<section id="behind-the-scenes-of-variable-assignment-using-python-s-disassembler">
<h3>Behind the Scenes of Variable Assignment Using Python’s Disassembler<a class="headerlink" href="#behind-the-scenes-of-variable-assignment-using-python-s-disassembler" title="Link to this heading"></a></h3>
<p>If you’re curious about what Python’s doing behind the scenes when a variable gets assigned or reassigned, you can get explore the bytecode that Python generates when it happens. We can use Python’s dis (disassembly) module for this. (Note that this is part of the standard runtime, and does not need to be installed using Pip).</p>
<p>Let’s see what happens when we assign a variable to a numerical constant, a string constant, and another variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dis</span> <span class="kn">import</span> <span class="n">dis</span>

<span class="k">def</span> <span class="nf">show_variable_use</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>

<span class="n">dis</span><span class="p">(</span><span class="n">show_variable_use</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="m">4</span><span class="w">           </span><span class="m">0</span><span class="w"> </span>LOAD_CONST<span class="w">               </span><span class="m">1</span><span class="w"> </span><span class="o">(</span><span class="m">42</span><span class="o">)</span>
<span class="w">              </span><span class="m">2</span><span class="w"> </span>STORE_FAST<span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>x<span class="o">)</span>

<span class="w">  </span><span class="m">5</span><span class="w">           </span><span class="m">4</span><span class="w"> </span>LOAD_CONST<span class="w">               </span><span class="m">2</span><span class="w"> </span><span class="o">(</span><span class="s1">&#39;Hello&#39;</span><span class="o">)</span>
<span class="w">              </span><span class="m">6</span><span class="w"> </span>STORE_FAST<span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>x<span class="o">)</span>

<span class="w">  </span><span class="m">6</span><span class="w">           </span><span class="m">8</span><span class="w"> </span>LOAD_FAST<span class="w">                </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>x<span class="o">)</span>
<span class="w">             </span><span class="m">10</span><span class="w"> </span>STORE_FAST<span class="w">               </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>y<span class="o">)</span>
<span class="w">             </span><span class="m">12</span><span class="w"> </span>LOAD_CONST<span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>None<span class="o">)</span>
<span class="w">             </span><span class="m">14</span><span class="w"> </span>RETURN_VALUE
</pre></div>
</div>
<p>The leftmost column refers to the line number in the source, so on line 4, the two bytecodes LOAD_CONST and STORE_FAST Load the constant value 42 to an int object, then save it in the variable (reference) named x. A similar thing is happening on line 5, except we’re now loading a string constant to an object and saving a reference to it in x. (The original int object is now eligible to be garbage collected). Finally, on line 6, we introduce a new variable, and here instead of loading a constant to an object, we look up the variable using LOAD_FAST.</p>
</section>
</section>
<section id="exploring-python-variables-and-types-a-guide-for-beginners">
<h2>Exploring Python Variables and Types: A Guide for Beginners<a class="headerlink" href="#exploring-python-variables-and-types-a-guide-for-beginners" title="Link to this heading"></a></h2>
<p>Before we begin, if objects are new to you, you might want to read P<a class="reference external" href="https://codesolid.com/getting-started-with-python-classes/">ython Classes Zero to Expert: A Tutorial With Exercises</a>.</p>
<p>Unlike languages like Java and C#, there are no “primitive types” in Python, only references to objects. That means things like numerical literals are also objects. So are functions and almost anything you can write in Python except operator symbols like +, -, etc. (Soapbox: for a language that some people unfairly criticize as “just a scripting language”, Python is one of the most thoroughly object-oriented languages I’ve ever used).</p>
<p>Python objects and the types they’re based on have excellent support for inspection. You can inspect their type and what functions they support, and get interactive help based on the docstrings in the code. Suppose we have a variable, user_id, and we want to know if it’s stored as an integer or a string. We could print it, but if it’s an integer value stored as a string, the output will be the same, as we saw above.</p>
<section id="the-python-type-function-displaying-the-object-class-of-a-variable">
<h3>The Python Type Function: Displaying the Object Class of a Variable<a class="headerlink" href="#the-python-type-function-displaying-the-object-class-of-a-variable" title="Link to this heading"></a></h3>
<p>The most common approach to discovering a variable’s type in Python is the simplest: use the <code class="docutils literal notranslate"><span class="pre">type</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">user_id</span><span class="p">))</span>

<span class="c1"># Outputs (for example)</span>
<span class="c1"># &lt;class &#39;str&#39;&gt;</span>
</pre></div>
</div>
</section>
<section id="listing-the-available-functions-in-python-with-dir">
<h3>Listing the Available Functions in Python with Dir<a class="headerlink" href="#listing-the-available-functions-in-python-with-dir" title="Link to this heading"></a></h3>
<p>Python’s <code class="docutils literal notranslate"><span class="pre">dir</span></code> function returns the methods on an object as a list.</p>
<p>Now suppose need to manipulate the user_id a bit. For example, let’s say we’ve been asked to trim the whitespace only on the left side of the user_id. Before writing some code to do that, let’s see if there’s a method available on the string class. We can display the available functions as a list using <code class="docutils literal notranslate"><span class="pre">print(dir(greeting))</span></code>. This will print a rather long list, but scanning through it quickly, we see a section that looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...<span class="s1">&#39;lower&#39;</span>,<span class="w"> </span><span class="s1">&#39;lstrip&#39;</span>,<span class="w"> </span><span class="s1">&#39;maketrans&#39;</span>,<span class="w"> </span><span class="s1">&#39;partition&#39;</span>...
</pre></div>
</div>
<p>We don’t see anything like trim_left, but <code class="docutils literal notranslate"><span class="pre">lstrip</span></code> looks promising.</p>
</section>
<section id="getting-help-reading-the-function-documentation">
<h3>Getting Help: Reading the Function Documentation<a class="headerlink" href="#getting-help-reading-the-function-documentation" title="Link to this heading"></a></h3>
<p>Let’s print out what it does with the help function. The screenshot below shows the output we’re interested in:</p>
<p><img alt="The python help function displays " src="../_images/image-315.png" /></p>
<p>Sure enough, lstrip is exactly the function we want in this case. By the way, if you’re working in Jupyter Notebook, you can get the same information using <code class="docutils literal notranslate"><span class="pre">user_id.lstrip?</span></code></p>
</section>
</section>
<section id="python-type-hints-making-types-explicit">
<h2>Python Type Hints: Making Types Explicit<a class="headerlink" href="#python-type-hints-making-types-explicit" title="Link to this heading"></a></h2>
<section id="why-python-introduced-type-hints">
<h3>Why Python Introduced Type Hints<a class="headerlink" href="#why-python-introduced-type-hints" title="Link to this heading"></a></h3>
<p>Although Python’s dynamic types make it beginner friendly, it has some unintended consequences.</p>
<p>The first consequence has to do with performance. As a rule, statically typed languages can take advantage of compile-time optimizations and have less overhead at runtime, so their performance is generally better than dynamically typed languages. C, C++, and Rust are all more performant than Python or Ruby, for example.</p>
<p>The second consequence of dynamic typing is that, although it’s beginner-friendly, there is no way to do static checking to ensure that arguments to functions have the correct type, or that what’s returned from the function is correct. As we’ll see shortly, this is the problem that type hints solve, but first, let’s look at an example to illustrate the problem.</p>
<p>Taking our old friend user_id, consider the following code, which presumably reads a user from a database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
     <span class="c1"># Returns something ...</span>
</pre></div>
</div>
<p>With the above information, we don’t really know how to call the function without reading it. Is user_id a string? An int? Perhaps it’s a uuid (a unique identifier object)? Also, what’s returned from the function? We might guess that It’s a user object, but it could just as well be a dictionary or a string with the user’s first and last name. By convention, the has a docstring to help so you can use help on it, but it would be nice if we could both understand it at a glance and have a tool to validate the results.</p>
</section>
<section id="type-hint-typing-module-and-basic-syntax">
<h3>Type Hint Typing Module and Basic Syntax<a class="headerlink" href="#type-hint-typing-module-and-basic-syntax" title="Link to this heading"></a></h3>
<p>To address this second consequence, Python 3.5 introduced a new module, typing, which formally added many new, related classes to help make type hints available to the Python language. (For completeness, we should point out that although type hints were officially available in 3.5, the syntax it relies on is somewhat backward compatible).</p>
<p>Python’s type hints make it easy to rework the function above. For example, suppose we replaced it this way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<p>Several advantages fall out of this simple change:</p>
<ul class="simple">
<li><p>We now know at a glance that the user_id is an integer value. Perhaps it’s a key to an auto-increment field in a SQL database.</p></li>
<li><p>We know that a User object is returned.</p></li>
<li><p>If we want more information about the User object, most IDEs will let us navigate to the definition of the class easily. For example, in VS-Code, you can alt-click (cmd-click on Mac) on the User object to bring you to the object’s source code.</p></li>
</ul>
<p>Breaking down the syntax a bit:</p>
<ul>
<li><p>The parameter’s name comes first, followed optionally by a colon and a type.</p></li>
<li><p>If there’s a default value for the parameter, it comes after the type. For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">set_shipping_option(default:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&quot;ground&quot;)...</span></code></p>
</li>
<li><p>For return values, place an “-&gt;” after the closing parenthesis, not after the colon marking the block. Follow this with the type returned and a colon.</p></li>
</ul>
</section>
<section id="static-type-checking-in-python">
<h3>Static Type Checking in Python<a class="headerlink" href="#static-type-checking-in-python" title="Link to this heading"></a></h3>
<p>Type hints are optional and will remain so – this is by design. So you don’t need to add them. Nor does adding them change the behavior of your program in any way. This is even true of cases where your program calls a function “incorrectly.” Consider the following program, which we’ll call bug.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># bug.py </span>
<span class="c1"># Don&#39;t do this.  Violate the greet_user type hint</span>

<span class="k">def</span> <span class="nf">greet_user</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">greet_user</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
</pre></div>
</div>
<p>You might expect that program to fail based on the type declaration, but it runs fine. The goal of the typing specification as outlined in PEP 484 was to standardize and support the function annotations that type checking was based on. As it’s outlined there:</p>
<blockquote>
<div><p>Note that this PEP still explicitly does NOT prevent other uses of annotations, nor does it require (or forbid) any particular processing of annotations, even when they conform to this specification. It simply enables better coordination, as PEP 333 did for web frameworks.</p>
<p><a class="reference external" href="https://peps.python.org/pep-0484/">PEP 484 - Type Hints</a></p>
</div></blockquote>
<p>To expose the bug in bug.py, we need to run it through a third-party static type checker. One that’s commonly used for this purpose is mypy</p>
</section>
</section>
<section id="using-mypy-for-static-type-checking">
<h2>Using MyPy for Static Type Checking<a class="headerlink" href="#using-mypy-for-static-type-checking" title="Link to this heading"></a></h2>
<section id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h3>
<p>You can install mypy easily using either pip or conda. Once installed, you can run it on either a package or a single file. The screenshot below shows the result of running the following command on the program above:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mypy<span class="w"> </span>bug.py
</pre></div>
</div>
<p><img alt="Example showing an error reported by mypy.  Argument 1 to &quot;greet_user&quot; has incompatible type &quot;int&quot;; expected &quot;str&quot;" src="../_images/image-55.png" /></p>
<p>Running mypy from the command line like this is certainly one way to go, and is commonly used in automation to ensure our code is correct as we go along. For example, git users may want to automate this using a pre-commit hook.</p>
<p>For day-to-day development, however, it’s better to correct these errors as soon as we make them. With this in mind, let’s consider integrating mypy with VS Code or Jupyter.</p>
</section>
<section id="using-mypy-with-vs-code">
<h3>Using MyPy with VS Code<a class="headerlink" href="#using-mypy-with-vs-code" title="Link to this heading"></a></h3>
<p>Assuming you installed mypy as above into the environment that’s set as your current Python interpreter in VS Code, you can easily enable mypy in two steps:</p>
<ol class="arabic simple">
<li><p>In the command palette (Shift-Alt-P / Shift-Cmd-P), search for lining and select “Python: Enable/Disable Linting,” then click on “Enable.”</p></li>
<li><p>Next, also in the command palette, search for “Python: Select Linter,” and in the list that pops up, select mypy.</p></li>
</ol>
<p>Once this is done, the value 1234 in greet_users will have a red wavy line beneath it to signal an error (easier to see on a light theme). If you need more information, you can hover over the error to see details:</p>
<p><img alt="Mypy error displayed in Visual Studio Code.  Argument 1 to &quot;greet_user&quot; has incompatible type &quot;int&quot;; expected &quot;str&quot;" src="../_images/image-6-1024x294.png" /></p>
</section>
<section id="using-mypy-with-jupyter-notebook-jupyter-lab">
<h3>Using MyPy with Jupyter Notebook / Jupyter Lab<a class="headerlink" href="#using-mypy-with-jupyter-notebook-jupyter-lab" title="Link to this heading"></a></h3>
<p>If you’re using Jupyter, the nb-mypy package provides excellent support for validating type hints with mypy. To get started with nb-mypy, install it using pip. (As far as I know, no Conda packages are available for it in the main Conda channels). Once it’s installed, you enable it in Jupyter using the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">load_ext</span> <span class="n">nb_mypy</span>
</pre></div>
</div>
<p>An excellent feature of this extension is how foolproof it is. Nb_mypy checks each cell as you try to run it. For example, here’s what we get when we copy the contents of bug.py into Jupyter:</p>
<p><img alt="A mypy error in Jupyter Notebook.  Argument 1 to &quot;greet_user&quot; has incompatible type &quot;int&quot;; expected &quot;str&quot;" src="../_images/image-7-1024x206.png" /></p>
</section>
</section>
<section id="advanced-type-hints-and-the-python-typing-module">
<h2>Advanced Type Hints and the Python Typing Module<a class="headerlink" href="#advanced-type-hints-and-the-python-typing-module" title="Link to this heading"></a></h2>
<p>So far, the examples we’ve shown have all been pretty simple, using built-in and user-defined types. In this section, we want to cover a few slightly more advanced techniques and some of the features of the typing module.</p>
<section id="collections-types-and-type-aliases">
<h3>Collections Types and Type Aliases<a class="headerlink" href="#collections-types-and-type-aliases" title="Link to this heading"></a></h3>
<p>We’ve covered how to work with simple types, but next, let’s consider how to work with collection types. There are two ways you might want to specify a collection type. You might want to enforce that a function accepts or returns a collection containing any element. In this case, you can simply use the collection type name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_list</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>A second common option is to make the type hint more precise by specifying the type the collection must contain. In Python 3.9 and above, you can use the collection name directly, followed by the type in square brackets. Here is an example, where we enforce that both the key and the value will be strings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_blog_info</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://codesolid.com&quot;</span><span class="p">,</span> <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="s2">&quot;Python&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Before version 3.9, if you needed to use generics like this, you had to import a class designed for that purpose from the typing module. Often the names of these classes were the uppercased version of the class name for the collection: List, Set, Dict, etc. Here for example we specify that a factorial function must be passed a list of integers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use this for 3.8 and earlier, otherwise just use lowercase &quot;list&quot;:</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">list_of_ints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;returns a factorial of a list of integers, cf https://en.wikipedia.org/wiki/Factorial&quot;&quot;&quot;</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_of_ints</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nb">sum</span> <span class="o">*=</span> <span class="n">val</span>        
    <span class="k">return</span> <span class="nb">sum</span>

<span class="n">first_five</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">first_five</span><span class="p">))</span>
</pre></div>
</div>
<p>Output: 120.</p>
<p>Importing these names from the typing module is now deprecated, and may be removed sometime after October 2025 (Python 3.9’s end of life), per PEP 585.</p>
<p>If you have a typed collection or other type declaration that you use often, type aliases are easy to write and let you specify an alias for that type. The syntax is simply AliasName = type specification. For example, here are some type aliases for two different kinds of dictionaries, and an example showing one of them in use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Type aliases </span>
<span class="n">MapIntToInt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<span class="n">MapStringToInt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_ages</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MapStringToInt</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;mom&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;dad&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="union-types">
<h3>Union Types<a class="headerlink" href="#union-types" title="Link to this heading"></a></h3>
<p>A union type allows you to specify that a function will accept or return one of two or more types. For example, suppose you were writing a function that accepts a date, and you want to specify that it will either take a date in a known format (for example, “2015-03-15”) or a Python date object. You could do it like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="k">def</span> <span class="nf">show_expiration</span><span class="p">(</span><span class="n">expires</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">date</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expires on: </span><span class="si">{</span><span class="n">expires</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    
<span class="n">show_expiration</span><span class="p">(</span><span class="s2">&quot;2059-06-20&quot;</span><span class="p">)</span>
<span class="n">show_expiration</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2059</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that beginning in Python 3.10, you can write union types more concisely. The function above, for example, could be written as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_expiration</span><span class="p">(</span><span class="n">expires</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expires on: </span><span class="si">{</span><span class="n">expires</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This more recent syntax can also be used to express an optional type. An optional type either contains a value or None. For example, <code class="docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></code> represents an argument that’s either a float or None. Before 3.10, this could be done would be written using the Optional type, as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="k">def</span> <span class="nf">some_function</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># . . .</span>
</pre></div>
</div>
</section>
</section>
<section id="literal-types">
<h2>Literal Types<a class="headerlink" href="#literal-types" title="Link to this heading"></a></h2>
<p>Generally speaking, type hints are aptly named because they don’t let you check anything <em>except</em> the type. Literal types are an exception to this general rule, however, since they let you check that a parameter is a given value, or within a range of values.</p>
<p>Suppose we’re writing a comparison function for a sort operation. We’re passed two strings, and have to return 1 if the first would come before the second in a language dictionary, zero if they’re the same, or -1 if the first comes after the second. Here is how the function might be written to make the return value clear:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span>

<span class="k">def</span> <span class="nf">compare_strings</span><span class="p">(</span><span class="n">first</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Literal</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="c1"># . . .</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading"></a></h2>
<p>If you made it this far, thank you for hanging in there! There was a lot to digest. Even with all that, we haven’t covered everything there is to learn about the typing module. For more detailed information, the following Google query will fetch you the most current official documentation: “docs.python.org typing.”</p>
<p>Type hints are a great feature in Python 3 that can make your code easier to understand and therefore easier to use. It also enables automatic checking, meaning your code is more likely to be correct. Having the types specified explicitly also makes it easier to navigate in an IDE.</p>
<p>Best of all, it’s optional. If you just need to write a quick script, you can still write your functions as you always did. However, type hints are definitely the way to go for larger projects and especially for libraries. With type hints, your users will know exactly how to call your code with the correct arguments and can use automated tools to help them improve their own code.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>