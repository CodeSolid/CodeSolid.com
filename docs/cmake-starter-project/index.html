<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A CMake Starter Project &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=19645805"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Code Pride is the Best Medicine" href="../code-pride-is-the-best-medicine/" />
    <link rel="prev" title="Chemists Strongly Addicted to Python!" href="../chemists-strongly-addicted-to-python/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jupyter:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../beautiful-documentation-with-jupyterbook/">My Journey to Beautiful Documentation With JupyterBook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter-lite-python-in-the-browser-with-serverless-jupyter/">Jupyter Lite:  Python in the Browser with Serverless Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter-notebook-a-complete-introduction/">Jupyter Notebook: A Complete Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run-python-online-with-jupyterlite/">Run Python Online: Watch the Video to Learn How</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../all_files/">Site Index</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../a-coop-coding-bootcamp/">A Coop Coding Bootcamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../airflow-python-etl/">Apache Airflow:  Python ETL and Scheduling Made Easy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alternatives-to-pandas-python-polars/">Alternatives to Pandas:  Python Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-command-line-skills-to-rock-your-development-world/">Learn Basic Command Line Skills and Rock Your Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../beautiful-documentation-with-jupyterbook/">My Journey to Beautiful Documentation With JupyterBook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmarking-python-and-rust-async-web-server-performance/">Benchmarking Python and Rust Async Web Server Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../boolean-expressions-python/">Boolean Expressions in Python: Beginner to Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building-a-docker-golang-container/">Building a Docker Golang Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../career-paths-for-python-programmers/">Best Python Careers: New Research Reveals Top Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chemists-strongly-addicted-to-python/">Chemists Strongly Addicted to Python!</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">A CMake Starter Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#part-i-a-brief-review-of-the-cmake-tutorial">Part I: A Brief Review of the CMake Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-you-ll-learn-in-part-two">What You’ll Learn in Part Two</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-cmake-starter-project-a-test-first-approach">The CMake Starter Project: A Test First Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running-our-tests">Building and Running Our Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-library">Adding a Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-an-application-with-a-library-dependency">Adding an Application with a Library Dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#closing-thoughts-and-next-steps">Closing Thoughts and Next Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-the-code">Get the Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../code-pride-is-the-best-medicine/">Code Pride is the Best Medicine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codesolid-newsletter-11-29-2022/">CodeSolid Newsletter, 11/29/2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codesolid-newsletter-12-13-2022/">CodeSolid Newsletter 12/13/2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codesolid-newsletter-november-1-2022/">CodeSolid Python Newsletter:  November 1, 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codesolid-newsletter-october-25-2022/">CodeSolid Newsletter:  October 25, 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../codesolid-python-newsletter-december-28-2022/">CodeSolid Python Newsletter:  December 28, 2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpp-dev-containers/">C++ Dev Containers:  Custom Environments for VS Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../creating-a-python-interactive-plot/">Creating a Python Interactive Plot Using Matplotlib in Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data-cleaning-in-pandas/">Data cleaning in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging-python-in-vs-code/">Debugging Python in VS Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../directoryinfo-example/">DirectoryInfo Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dunder-methods-in-python-the-ugliest-awesome-sauce/">Python Dunder Methods:  The Ugliest Awesome Sauce</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exploring-python-objects-with-the-dir-and-type-functions/">Exploring Python Objects with the dir and type functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../finding-duplicates-in-a-list-in-python/">How to Find Duplicates In a List in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started-with-python-classes/">Python Classes Zero to Expert: A Tutorial with Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-things-done-with-dendron-and-vs-code-first-look/">Getting Things Done With Dendron and VS Code – First Look</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-things-done-with-github-markdown-and-visual-studio-code/">Getting Things Done with GitHub, Markdown, and Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../google-sheets-in-python-and-pandas/">How to Work With Google Sheets In Python and Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../heymoe/">Delme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-do-i-profile-python-code/">How To Profile Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-compare-python-dictionaries/">How To Compare Python Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-convert-a-string-to-datetime-in-python/">How to Convert a String to Datetime in Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-install-pip-and-conda-on-the-same-machine/">How To Install Pip and Conda on the Same Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-learn-to-program/">How to Learn To Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-practice-python-data-science-and-pandas/">How to Practice Python: Data Science and Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-practice-python/">How To Practice Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-separate-tests-and-source-for-python-tests/">How To Separate Source and Tests in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-use-docker-with-python/">How To Use Docker Python Images and Docker Compose With Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to-visualize-data-using-pandas/">How to Visualize Data Using Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-a-python-and-git-development-environment-on-windows-part-2/">Installing a Python and Git Development Environment on Windows, Part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-a-python-development-environment-on-windows/">Installing a Python and Git Development Environment on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introducing-sage-math-python-based-mathematics/">Introducing Sage Math:  Symbolic Math Software In Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../is-python-free-with-list-of-tools/">Is Python Free?  Yes!  We List the Best Free Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../is-python-slow/">Is Python Slow?  Separating the Myths from the Facts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../julia-vs-python-now-for-something-completely-different/">Is Julia Easy to Learn for Python Developers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter-lite-python-in-the-browser-with-serverless-jupyter/">Jupyter Lite:  Python in the Browser with Serverless Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter-notebook-a-complete-introduction/">Jupyter Notebook: A Complete Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kaggle-datasets/">Using the Kaggle Datasets API in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../large-data-sets-in-python-pandas-and-the-alternatives/">Large Data Sets in Python:  Pandas And The Alternatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learn-python/">Learn Python: Tutorials from Beginner to Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-c-and-python-the-perfect-duo-for-success/">Learning C++ and Python: The Perfect Duo for Success</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-git-what-to-know-when-youre-a-beginner/">Learning Git: What To Know When You’re a Beginner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mastering-the-take-home-coding-exercise-final-steps/">Mastering The Take-Home Coding Exercise: A Simple Checklist To Make It Shine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matplotlib-coordinates-toward-a-python-graphing-calculator/">Matplotlib Coordinates:  Graphing Math Functions in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matplotlib-vs-seaborn/">Matplotlib vs. Seaborn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../middle-way-of-software-development/">The Middle Way of Software Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mystnb-template/">Your Header here</a></li>
<li class="toctree-l2"><a class="reference internal" href="../new-for-2022-python-git-github-bootcamp-course/">New for 2022:  Python, Git, GitHub BootCamp Course</a></li>
<li class="toctree-l2"><a class="reference internal" href="../newsletter-11-15-2022/">Newsletter, 11/15/2022</a></li>
<li class="toctree-l2"><a class="reference internal" href="../newsletter-january-17-2023/">Python Newsletter, January 17, 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../node-starter-projects/">Node Starter Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes-on-using-postgres-python-and-docker/">Using Postgres, Python, and Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy-practice-questions-to-make-you-an-expert/">NumPy Examples –  Practice Questions Make You an Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizing-aws-s3-uploads-with-golang-and-goroutines/">Fast S3 Updates with Golang and Goroutines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandas-groupby/">How to Use the Pandas Groupby Method?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandas-practice-examples/">Pandas Examples and Review Questions to Make You an Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pip-vs-conda-two-top-tools-for-managing-python-packages/">Pip vs. Conda: Two Top Tools for Managing Python Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pip-vs-pipenv-which-is-better-and-which-to-learn-first/">Pip vs Pipenv: Which is better and which to learn first?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming-and-math-a-brief-translation-guide/">Programming and Math:  A Brief Translation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pycharm-vs-vs-code/">PyCharm vs. VS Code: Which Is Better and Why?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pypy-first-look-a-faster-version-of-python/">Is PyPy a Faster Version of Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-and-aws-getting-started-with-the-cloud-development-kit-cdk/">Python and AWS:  Getting Started with the Cloud Development Kit (CDK)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-and-aws-lambda-functions/">Python for AWS Lambda Functions: A Beginner’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-and-react-running-python-online-in-a-react-app/">Python and React:  Running Python Online in a React App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-boot-camp-a-co-operative-approach/">A Coding Boot Camp Run As a Cooperative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-chemistry/">Python Chemistry:  SymPy and ChemPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-chemistry/#python-chemistry-sympy-and-chempy-ca-oh-2-3-h3-po4-2">Python Chemistry:  SymPy and ChemPy{‘Ca(OH)2’: 3, ‘H3(PO4)’: 2}</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-configuration/">Python Configuration: Top Built-In and Third-Party Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-data-analysis-starter-project/">Python Data Analysis Starter Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-dataclasses/">Python Dataclass:  Easily Automate Class Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-date-tutorial/">Python Date and Time Functions: The Complete Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-dictionaries-with-exercises/">Python Dictionaries for Beginners:  A Complete Lesson With Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-docker-examples-sagemath-in-a-container/">Python Docker Examples:  SageMath in a Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-errors/">Python Errors: Exception Handling from Beginner to Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-files-from-beginner-to-expert/">Find Files in Python:  Complete Cookbook for Searching Files and Folders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-for-loop-a-complete-tutorial-with-exercises/">The Python For Loop:  Complete Tutorial and Practice Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-format-strings/">Python Format Strings: Beginner to Expert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-function-arguments-and-parameters-examples/">Python Function Arguments: The Complete Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-function-best-practices/">Python Function Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-function-exercises/">Python Function Exercises With Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-functions/">Python Functions: Introduction to the Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-generators-questions-and-answers/">Python Generator Functions: The Complete Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-hobbyist-to-professional/">A Tech Career in Python:  From Hobbyist to Professional</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-indexing-slicing-exercises/">Python Indexing and Slicing: Complete Tutorial With Hands-On Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-json-easily-work-with-dictionaries-files-and-custom-objects/">Python JSON: Easily Work With  Dictionaries, Files, and Custom Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-lists-vs-arrays/">Python Lists vs. Arrays:  How to Choose Between Them</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-lists/">Python Lists for Beginners: A Complete Lesson With Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-matrix-multiplication/">Python Matrix Multiplication: NumPy, SymPy, and the Math Behind It</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-newsletter-february-22-2023/">Python Newsletter February 22, 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-newsletter-january-31-2023/">Python Newsletter, January 31, 2023</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-on-docker-practice-ideas/">Python Practice:  More Python on Docker Project Ideas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-operators/">Python Operators:  The Building Blocks of Successful Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-package-example-setuptools/">Python Package Example: Setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-postgres-and-docker-running-fast-meaningful-unit-tests/">Python, Postgres, and Docker:  Running Fast, Meaningful Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-practice-projects/">What Are Good Projects To Practice In Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-pyarrow-and-parquet/">Python Parquet and Arrow:  Using PyArrow with Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-pyarrow-and-parquet/#python-parquet-and-arrow-using-pyarrow-with-pandaspickup-2019-03-23-20-21-09-000000000-2019-03-04-16-11-55-000000000-2019-03-27-17-53-01-000000000-2019-03-10-01-23-59-000000000-2019-03-30-13-27-42-000000000">Python Parquet and Arrow:  Using PyArrow with Pandaspickup: [[2019-03-23 20:21:09.000000000,2019-03-04 16:11:55.000000000,2019-03-27 17:53:01.000000000,2019-03-10 01:23:59.000000000,2019-03-30 13:27:42.000000000]]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-shell-programming/">Python Shell Programming: Overview and Top Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-string-examples-tutorial-and-practice-exercises/">Python String Examples:  Tutorial and Practice Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-virtual-environments-video-tutorial/">Python Virtual Environments: Video Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-vs-matlab/">Python vs. MATLAB: Price, Performance, Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-with-using-and-writing-context-managers-in-python/">Python With: Using and Writing Context Managers in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random-python-secrets-and-random-values-made-easy/">Random Python:  Secrets and Random Values Made Easy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../run-python-online-with-jupyterlite/">Run Python Online: Watch the Video to Learn How</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running-the-cmake-tutorial-in-a-vs-code-dev-container/">Running the CMake Tutorial in a VS Code Dev Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scipy-vs-sympy-for-symbolic-math-let-us-never-speak-of-this-again/">SciPy vs. SymPy for Symbolic Math:  Let Us Never Speak of This Again</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selecting-data-in-pandas/">Selecting Data in Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simplicity-is-your-friend-python-vs-vs-code-for-teaching-software/">Simplicity is your Friend:  PyCharm vs. VS Code for Teaching Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sql-with-pandas/">Using SQL With Pandas:  PandasSQL and IPython-SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sqlalchemy-dataclass-example/">SQLAlchemy DataClass Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sympy-solving-math-equations-in-python/">SymPy:  Solving Math Equations in Python and Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../teach-yourself-math/">Teach Yourself Math: Resources, Techniques, and Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test-dir/">Test Dir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../the-function-in-python-introductory-tutorial/">The Function In Python: An Introductory Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../the-marketing-genius-of-100-days-of-code/">The Marketing Genius of 100 Days of Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thonny-the-most-beginner-friendly-python-ide/">Thonny: The Most Beginner Friendly Python IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understanding-python-types-and-type-hints/">Understanding Python Types and Type Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../useful-collection-classes-in-python-you-may-not-know/">Useful Collection Classes in Python You May Not Know</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-pyspark-and-parquet/">PySpark and Parquet: Elegant Python DataFrames and SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using-testng-with-spring/">Using TestNG With Spring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vagrant-ansible-local/">Simple Vagrant Ansible Local Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what-are-those-pyc-files-in-a-python-project/">What Are pyc Files and <strong>pycache</strong> folders In Python ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what-is-a-python-package/">What Is a Python Package?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wherein-i-make-an-account-of-my-whereabouts/">Wherein I Make an Account of My Whereabouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../why-is-python-popular/">Why Is Python Popular?# Why Is Python Popular</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writing-a-python-custom-exception/">Writing a Python Custom Exception</a></li>
<li class="toctree-l2"><a class="reference internal" href="../your-first-development-job/">Stop Being a Junior Developer.  No, Seriously, Cut It Out.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../your-first-programming-language-should-be-python-not-javascript/">Your First Programming Language Should be Python, Not JavaScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zen-of-100-days-of-python/">The Strange Zen of 100 Days of Python</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../all_files/">Site Index</a></li>
      <li class="breadcrumb-item active">A CMake Starter Project</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cmake-starter-project.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="a-cmake-starter-project">
<h1>A CMake Starter Project<a class="headerlink" href="#a-cmake-starter-project" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>This article is a follow-on to my recent article, <a class="reference external" href="https://codesolid.com/running-the-cmake-tutorial-in-a-vs-code-dev-container/">Running the CMake Tutorial in a VS Code Container</a>. Toward the end of that tutorial, we built one of the tutorial steps and debugged it in a VS Code container. Since then, I’ve finished the tutorial and published my <a class="reference external" href="https://github.com/CodeSolid/c/tree/main/cmake_tutorial_solutions">solutions set</a>, in case you’re looking for one of those.</p>
<p>My purpose in the present article is twofold. First, if you’re on the verge of working through the tutorial yourself or have just slogged through it, I’ll share my experiences with it in a brief review. We’ll see that the tutorial has some limitations, so we’ll need to dig further into the tool to become more proficient with it. The best way to do that is to actually create a CMake build system for a simple (but flexible) starter project. We’ll do that step by step in the second part of the article.</p>
<p>Of course, I have a project of my own in mind, but I’ll resist the urge to get too far into that code, providing just enough detail so you can easily swap out that code with a project of your own.</p>
</section>
<section id="part-i-a-brief-review-of-the-cmake-tutorial">
<h2>Part I: A Brief Review of the CMake Tutorial<a class="headerlink" href="#part-i-a-brief-review-of-the-cmake-tutorial" title="Link to this heading">¶</a></h2>
<p>CMake’s tutorial does a pretty good job of walking you through a lot of the basic CMake properties and functions you’ll need to work with the tool to create libraries and executables (and link them, of course), and it does a fair job of introducing some advanced features like supporting installers, using generator expressions, etc. It’s broken down into a series of steps, each of which consists of a number of exercises. Generally, the exercises point you to the CMake documentation for the functions you’ll need to use, but a hidden section reveals the full code you need if you can’t work it out from the documentation.</p>
<p>For all but the simplest examples, however, this “point them to the documentation” approach suffers from a drawback of the documentation itself, that of not providing sufficient usage examples to be helpful on its own.</p>
<p>A more serious limitation is that there isn’t much discussion of how to work with third-party libraries (beyond the C++ standard library, of course). CMake is a build tool generator, of course, and not a package manager, but it does have some facilities for downloading and building packages. The most modern (and self-contained) of these are provided by the FetchContent module.</p>
<p>Because I’ve drunk a little too deeply over the years from the pitcher of TDD Kool-Aid, the first thing I want to do when creating a new project structure is to set up a way to run unit tests. The CMake tutorial does show you how to do this – so that’s good – but it shows you how to do this as integrated tests you write run from CMake against the main executable. Of course, you can figure out how to use the tools it teaches to integrate with other test systems, but what I really want to know is how to write my tests in a C++ file and build them in CMake like a regular human. Writing tests in a build tool is a lot like jumping off a cliff into the ocean: it’s nice to know it’s an option if murderers are chasing you in a movie, but that hardly makes it a best practice.</p>
<p>Finally, the tool does not go into much depth on best practices around setting up a project. One could argue that that’s not a tutorial’s job. To be sure, it contains a library and an executable, so there’s a starting point for that sort of thing, but many of the best practices enabled by recent enhancements to CMake have been left out. Of course, before working to create a more complex starter project, I wanted to explore some of those best practices. This article has been influenced especially by two resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cliutils.gitlab.io/modern-cmake/" title="An Introduction to Modern CMake">An Introduction to Modern CMake</a> – This is a great overall resource on managing third-party packages. Also, it offers an opinionated sample project structure that I found useful enough as a starting point. It’s light on code, though, so providing that inspired this article.</p></li>
<li><p><a class="reference external" href="https://crascit.com/2016/01/31/enhanced-source-file-handling-with-target_sources/" title="Enhanced source file handling with target_sources">Enhanced Source File Handling with target_sources</a> – Once you’ve selected a structure for your multi-directory project, this article is well worth consulting for how to keep it from getting difficult to manage.</p></li>
</ul>
</section>
<section id="what-you-ll-learn-in-part-two">
<h2>What You’ll Learn in Part Two<a class="headerlink" href="#what-you-ll-learn-in-part-two" title="Link to this heading">¶</a></h2>
<p>By the end of this tutorial:</p>
<ul class="simple">
<li><p>You’ll know how to set up a multi-folder CMake project, including a build directory containing debug and release builds, and how to automate the process of building. We’ll beg the question a bit here with a plain Makefile (for Gnu Make) (i.e., one different from one that the CMake build process generates as part of the build).</p></li>
<li><p>We’ll present a flexible method for including and building any CMake-compatible source that’s hosted in a GitHub repository (or other public repository). We won’t use Conan or other “package repositories” since the universe of open-source CMake projects on GitHub is far larger than the recipes listed on Conan.io (probably the largest such package repository).</p></li>
<li><p>We’ll illustrate the above points using the Catch2 unit test framework. However, the technique we show here will work with any framework, so you certainly could if you wanted to substitute GoogleTest (for example). We’ll also add a test target to our “external” Makefile.</p></li>
<li><p>Once we have testing in place, we’ll externalize our one test function to a library, which can also be linked to our main application, which we’ll also develop.</p></li>
</ul>
</section>
<section id="the-cmake-starter-project-a-test-first-approach">
<h2>The CMake Starter Project: A Test First Approach<a class="headerlink" href="#the-cmake-starter-project-a-test-first-approach" title="Link to this heading">¶</a></h2>
<p>Beginning from a plain directory, let’s consider what we need. We want to keep our root directory relatively clean with our main CMakeLists.txt project file, our Makefile helper, a README, and our .gitignore file.</p>
<p>Next, simplifying somewhat the suggested structure in the Introduction to Modern CMake site we mentioned earlier, we’ll build out a similar directory structure:</p>
<ul class="simple">
<li><p>root project directory</p>
<ul>
<li><p>test</p></li>
<li><p>build</p></li>
<li><p>lib</p></li>
<li><p>app</p></li>
</ul>
</li>
</ul>
<p>Of course, this structure may grow over time, but it’ll do for now. If it’s not obvious what goes where our unit tests will go in test, our main header file and library source will go in lib, our program using the library will go into the app directory, and all our artifacts will go into the build directory and subdirectories of it.</p>
<p>Let’s get started by focusing on our Main CMakeLists.txt file and the test directory. Our root CMakeLists.txt file first:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source_root/CMakeLists.txt</span>

cmake_minimum_required<span class="o">(</span>VERSION<span class="w"> </span><span class="m">3</span>.24<span class="o">)</span>
project<span class="o">(</span>Starter<span class="w"> </span>VERSION<span class="w"> </span><span class="m">0</span>.01<span class="o">)</span>

set<span class="o">(</span>CMAKE_CXX_STANDARD<span class="w"> </span><span class="m">17</span><span class="o">)</span>
set<span class="o">(</span>CMAKE_CXX_STANDARD_REQUIRED<span class="w"> </span>True<span class="o">)</span>

<span class="c1"># Test first</span>
add_executable<span class="o">(</span>tests<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">)</span>

add_subdirectory<span class="o">(</span><span class="nb">test</span><span class="o">)</span>
</pre></div>
</div>
<p>Outside of the comment (mainly for this article), the first two things we need are really boilerplate to make CMake work at all – a cmake_minimum_required statement and a project name and version. We’re so-very-creatively calling our starter project “Starter”, and our version number is quite humbly low.</p>
<p>The order of the next two lines (and the other lines we’ll be adding here) is important. In particular, any add_executable or add_library function calls <em>must</em> come <em>before</em> the corresponding add_subdirectory call. The reason for this is that the subdirectory’s CMakeLists.txt file’s job is to configure the target’s sources, dependencies, and so forth by the name we gave it when we added it, and if we haven’t added it yet, that’s bad. The clue will be CMake complaining that you’re trying to do something to a target that’s “not built by this project”.</p>
<p>Now let’s create our test directory and add this file to it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># test/CMakeLists.txt</span>

target_sources<span class="o">(</span>tests
<span class="w">    </span>PRIVATE
<span class="w">        </span>test.cpp
<span class="o">)</span>

include<span class="o">(</span>FetchContent<span class="o">)</span>
FetchContent_Declare<span class="o">(</span>
<span class="w">  </span>Catch2
<span class="w">  </span>GIT_REPOSITORY<span class="w"> </span>git@github.com:catchorg/Catch2.git
<span class="w">  </span>GIT_TAG<span class="w">        </span>4acc51828f7f93f3b2058a63f54d112af4034503<span class="w"> </span><span class="c1"># devel branch v. 3, as of 8/3/2023</span>
<span class="o">)</span>

FetchContent_MakeAvailable<span class="o">(</span>Catch2<span class="o">)</span>
target_link_libraries<span class="o">(</span>tests<span class="w"> </span>PRIVATE<span class="w"> </span>Catch2::Catch2WithMain<span class="o">)</span>
</pre></div>
</div>
<p>This isn’t too long yet, but there’s a fair amount going on that we should stop to consider. First, note the target_sources command that was highlighted in one of the articles we mentioned earlier. We’re saying that the “tests” executable that we added in our root file will have one PRIVATE source file, test.cpp. (“PRIVATE” in the context is a bit redundant for a test executable, but CMake syntax requires it).</p>
<p>Next, we’re going to declare and build our first external dependency. We include the FetchContent module, then make two calls:</p>
<ul class="simple">
<li><p>FetchContent_Declare takes a name, a repository, and a tag, branch, or commit name (labeled by GIT_TAG in any case).</p></li>
<li><p>FetchContent_MakeAvailable actually does the fetching and building of this project.</p></li>
</ul>
<p>Once we have the dependency “installed and built” in our CMake environment, we need to link our tests executable to one of the targets it exports. The first part of the name is consistent with what we used in our FetchContent calls. You’ll need to consult the project itself to see what it exports. In this case, “Catch2::Catch2WithMain” means we won’t need a main function in our test code since Catch2 gives us one that will do the right thing.</p>
<p>That’s all we need from a build perspective, but notice we need said we need a source file named test.cpp. To get one, we’re going to shamelessly copy the “hello-world” style Catch2 tutorial file:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch_test_macros.hpp&gt;</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Factorial</span><span class="p">(</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="n">number</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;Factorials are computed&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[factorial]&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="p">);</span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3628800</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There’s not much mystery here. The REQUIRE macro basically asserts that the boolean expression is true and halts the test case on failure. (To print the failure without halting the test, use CHECK). A benefit of Catch2 is that the boolean expression is just any C++ code you want. You don’t need to learn a set of matchers like EXPECT_MY_PUPPY_TO_BE_NAMED_BORIS. To be sure, this is just a toy example, and the limited range of these tests actually hides a bug (as we’ll demonstrate later). Moreover, this test case with essentially four asserts might give unit test purists the one-test-per-function vapors, but to paraphrase Mark Antony, “We come here to build this code, not to praise it.”</p>
</section>
<section id="building-and-running-our-tests">
<h2>Building and Running Our Tests<a class="headerlink" href="#building-and-running-our-tests" title="Link to this heading">¶</a></h2>
<p>So with that, let’s be about building and running the tests. For now, let’s do our first build from the command line. (I’m working on a Mac, and the same command line works for Linux. We’ll address making the code from this section truly cross-platform in a future post. Meantime, all our code and CMakeLists.txt will work on Windows as well.)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/Debug
<span class="nb">cd</span><span class="w"> </span>build/Debug
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>../..<span class="w"> </span>
cmake<span class="w"> </span>--build<span class="w"> </span>.
</pre></div>
</div>
<p>Next, let’s test run our tests. While still within the build/Debug directory in the project root, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./tests
</pre></div>
</div>
<p>You should see something like this, but of course, the random seed will be different:</p>
<p><img alt="" src="../_images/image1.png" /></p>
<p>At this point, we realize this project has a working set of unit tests, so we may have something good going on here. Let’s build a utility Makefile for our environment so we won’t have to remember all that stuff above:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main project builder</span>

.PHONY:<span class="w"> </span>build<span class="w"> </span><span class="nb">test</span><span class="w"> </span>clean

build:
<span class="w">	</span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/Release
<span class="w">	</span>mkdir<span class="w"> </span>-p<span class="w"> </span>build/Debug
<span class="w">	</span><span class="nb">cd</span><span class="w"> </span>build/Debug<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>../..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.
<span class="w">	</span><span class="nb">cd</span><span class="w"> </span>build/Release<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Release<span class="w"> </span>../..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.

<span class="c1"># Note this also cleans the third-party libraries we&#39;ve built.  This could be more fine-grained to improve build times.</span>
clean:
<span class="w">	</span>rm<span class="w"> </span>-rf<span class="w"> </span>build

<span class="c1"># Run the test</span>
test:<span class="w"> </span>
<span class="w">	</span>./build/Debug/tests<span class="w"> </span>

<span class="c1"># Show tests that pass too</span>
test-verbose:<span class="w"> </span>
<span class="w">	</span>./build/Debug/tests<span class="w"> </span>-s
</pre></div>
</div>
<p>I like to keep the output clean, but you can easily make the test depend on the build, like this if desired:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>test:<span class="w"> </span>build
<span class="w">	</span>./build/Debug/tests
</pre></div>
</div>
<p>Now without leaving the root, you can use “<code class="docutils literal notranslate"><span class="pre">make</span></code>” (default target is the same as <code class="docutils literal notranslate"><span class="pre">&quot;make</span> <span class="pre">build,&quot;</span></code> since it’s the first target), “<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code>” to run the tests, etc.</p>
</section>
<section id="adding-a-library">
<h2>Adding a Library<a class="headerlink" href="#adding-a-library" title="Link to this heading">¶</a></h2>
<p>At this stage, we have a working build and some unit tests, but it’s still just a toy project. Having the code and the tests together like this is perhaps useful while you’re working out new ideas in development (as we’ve done here), but really what we want is to have the tests consume a library. Then the tests we develop will help us maintain any executables that we (or others) link to the same library.</p>
<p>As a first step, let’s change our CMakeLists.txt file to look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source_root/CMakeLists.txt</span>

cmake_minimum_required<span class="o">(</span>VERSION<span class="w"> </span><span class="m">3</span>.24<span class="o">)</span>
project<span class="o">(</span>Starter<span class="w"> </span>VERSION<span class="w"> </span><span class="m">0</span>.01<span class="o">)</span>

set<span class="o">(</span>CMAKE_CXX_STANDARD<span class="w"> </span><span class="m">17</span><span class="o">)</span>
set<span class="o">(</span>CMAKE_CXX_STANDARD_REQUIRED<span class="w"> </span>True<span class="o">)</span>

<span class="c1"># Add libraries and executables first, </span>
<span class="c1"># before add_subdirectory calls</span>
add_library<span class="o">(</span>lib<span class="o">)</span>
add_executable<span class="o">(</span>tests<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">)</span>

add_subdirectory<span class="o">(</span>lib<span class="o">)</span>
add_subdirectory<span class="o">(</span><span class="nb">test</span><span class="o">)</span>
</pre></div>
</div>
<p>Since our last version, we’ve added two lines, both having to do with the “lib” library, <code class="docutils literal notranslate"><span class="pre">add_library</span></code> and <code class="docutils literal notranslate"><span class="pre">add_subdirectory</span></code>. What’s important is that we keep all the <code class="docutils literal notranslate"><span class="pre">add_subdirectory</span></code> calls at the end, but the order within each section doesn’t matter. We’ve added the library first, though, as a way of documenting that the executable will depend on it.</p>
<p>Next, let’s build out the library itself. Make a directory off the root called lib. You should now have a root directory that looks like this:</p>
<p><img alt="Root directory from &quot;tree -L&quot; after adding the lib directory." src="../_images/image-12.png" /></p>
<p>In the lib directory, let’s start by creating a cpp file, lib.cpp: We’ll simply move the Factorial definition from root/test/test.cpp, and include a header for it. Here’s how that looks:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;lib.h&quot;</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Factorial</span><span class="p">(</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Factorial</span><span class="p">(</span><span class="n">number</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">number</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In root/test.cpp, we also need to add this line at the top beneath our other header:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;lib.h&gt;</span>
</pre></div>
</div>
<p>Next, we need to build that header file with the function prototype:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Factorial</span><span class="p">(</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>Now that we’ve changed our root CMake CMakeLists.txt and the source code, we need a CMakeLists.txt file in the lib directory, too! Here’s that file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># lib/CMakeLists.txt</span>

target_sources<span class="o">(</span>lib
<span class="w">    </span>PUBLIC
<span class="w">      </span>lib.h
<span class="w">    </span>PRIVATE
<span class="w">      </span>lib.cpp
<span class="o">)</span>

target_include_directories<span class="o">(</span>lib<span class="w"> </span>INTERFACE<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>We make the lib.cpp file private since other targets don’t need to include it. For the header, we make it public and add the line below it:</p>
<p><code class="docutils literal notranslate"><span class="pre">target_include_directories(lib</span> <span class="pre">INTERFACE</span> <span class="pre">&quot;${CMAKE_CURRENT_SOURCE_DIR}&quot;)</span></code></p>
<p>I may have been somewhat critical of the CMake tutorials earlier, but I now confess that I looked this trick up in the Tutorial code I worked on when I initially had to figure out why the test wasn’t building because of the include. To fix that, you need the code so far and one less step. We add a line to link to the library above the existing target_link_libraries call, as shown below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#Add this line to test/CMakeLists.txt:</span>
target_link_libraries<span class="o">(</span>tests<span class="w"> </span>PRIVATE<span class="w"> </span>lib<span class="o">)</span>

target_link_libraries<span class="o">(</span>tests<span class="w"> </span>PRIVATE<span class="w"> </span>Catch2::Catch2WithMain<span class="o">)</span>
</pre></div>
</div>
<p>At this point, we can run “<code class="docutils literal notranslate"><span class="pre">make</span></code>” and “<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code>” again and everything should build and work as it did before.</p>
</section>
<section id="adding-an-application-with-a-library-dependency">
<h2>Adding an Application with a Library Dependency<a class="headerlink" href="#adding-an-application-with-a-library-dependency" title="Link to this heading">¶</a></h2>
<p>Given where we are, with the tests depending on the library, adding another target doing the same thing is a simple matter of creating a new directory and reworking things a bit using techniques we’ve already mastered. First, we create the app directory underneath the project root. In it, we add a short new CMakeLists.txt file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># app/CMakeLists.txt</span>

target_sources<span class="o">(</span>factorial
<span class="w">    </span>PRIVATE
<span class="w">        </span>app.cpp
<span class="o">)</span>

target_link_libraries<span class="o">(</span>factorial<span class="w"> </span>PRIVATE<span class="w"> </span>lib<span class="o">)</span>
</pre></div>
</div>
<p>We also add the app.cpp file that’s mentioned in CMakeLists.txt as a target source:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// app/app.cpp</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;lib.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Usage: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span>
<span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; number&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">stoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;! = &quot;</span><span class="w"> </span>
<span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">Factorial</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For the target_sources and target_link_libraries calls in the CMakeLists.txt file here to work, the target we’re referencing has to exist, of course, so we modify the root CMakeLists.txt file, adding the following two lines:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># source_root/CMakeLists.txt</span>

<span class="c1"># ...</span>
<span class="c1"># Add this at the end of the add_library and add_executable section</span>
add_executable<span class="o">(</span>factorial<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">)</span>

<span class="c1"># ...</span>
<span class="c1"># Add this as the last line in the file:</span>
add_subdirectory<span class="o">(</span>app<span class="o">)</span>
</pre></div>
</div>
<p>We can now build and test out our app from the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make

./build/Debug/factorial
Usage:<span class="w"> </span>./build/Debug/factorial<span class="w"> </span>number

<span class="c1"># A little math notation in the output</span>
./build/Debug/factorial<span class="w"> </span><span class="m">3</span>
<span class="m">3</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="w"> </span>

<span class="c1"># Here&#39;s the bug we mentioned earlier.  After a certain point </span>
<span class="c1"># (likely machine dependent and perhaps involving integer overflow), this happens:</span>
/build/Debug/factorial<span class="w"> </span><span class="m">33</span>
<span class="m">33</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2147483648</span>

./build/Debug/factorial<span class="w"> </span><span class="m">34</span>
<span class="m">34</span>!<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<p>Of course, the bug in our library is not our concern. The contents of the library code, our test code, and our app code are all just there as stubs so we can test that our CMake build script works and runs correctly.</p>
</section>
<section id="closing-thoughts-and-next-steps">
<h2>Closing Thoughts and Next Steps<a class="headerlink" href="#closing-thoughts-and-next-steps" title="Link to this heading">¶</a></h2>
<p>In our use of the FetchContent module and functions in test/CMakeLists.txt, we’ve seen a straightforward method for consuming pinned dependencies from CMake. We’ve learned not only how to separate a library from its executable dependencies (a topic covered, after all, in the CMake tutorial), but we’ve also shown how to keep the main (root) CMake file minimal, making each target’s directory CMake file responsible for whatever that target needs to build.</p>
<p>There are several next steps you might take, some of which we may also cover here in follow-on articles. For example:</p>
<ul class="simple">
<li><p>We pointed out that our utility Makefile is not really cross-platform. Moreover, it relies on Gnu Make, a separate download everywhere but on Linux. One possibility would be to script a series of [CMake cross-platform commands](http://Run a Command-Line Tool) and process it with <code class="docutils literal notranslate"><span class="pre">CMake</span> <span class="pre">-P</span></code>. Another would be to either document the CMake steps and just run them (which is tedious) or to create a separate utility file for bash and windows batch (or Powershell).</p></li>
<li><p>We only demonstrated how to use FetchContent on one dependency, Catch2. Your library project is sure to need many more of its own. Generally, separating these out as needed is a good thing, but there is an interesting corner case to consider. There may be certain code that you want to test (for example, the code that parses configuration files or command line arguments for your application). You might not want this in your library since external clients don’t care about it, but linking the tests to an executable will not work. Different solutions to this include testing the executable code manually (i.e., by running the application), creating a separate “UI utility” library, or excluding the code from your public library that your app and test suite use by creating two targets against the same directory.</p></li>
<li><p>There are other alternatives to FetchContent that we haven’t considered here. Many developers, including the author of the Modern CMake article (cited earlier), are fond of Git submodules. It may be, however, that the packages you need can all be found on conan.io. If that’s the case, you might find this <a class="reference external" href="https://github.com/conan-io/cmake-conan" title="CMake Conan plugin useful">CMake Conan plugin</a> to be useful. Either way, it might also be useful to separate the dependencies out as a separate target since our current “make clean” command forces a rebuild of everything, even the dependencies. This is not ideal from the perspective of having a relatively clean build that’s also fast.</p></li>
<li><p>The Isabella Muerte quote in our top-of-page featured image certainly applies to the issue of different dependency sources and methods, but it also applies to build tools. We’ve been writing about CMake first since it’s most popular in the C and C++ world, but there is a lot of buzz around <a class="reference external" href="https://mesonbuild.com/">Meson</a> in particular.</p></li>
</ul>
</section>
<section id="get-the-code">
<h2>Get the Code<a class="headerlink" href="#get-the-code" title="Link to this heading">¶</a></h2>
<p>The code for this article is hosted on GitHub in the cmake_starter folder of <a class="reference external" href="https://github.com/CodeSolid/c">https://github.com/CodeSolid/c</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../chemists-strongly-addicted-to-python/" class="btn btn-neutral float-left" title="Chemists Strongly Addicted to Python!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../code-pride-is-the-best-medicine/" class="btn btn-neutral float-right" title="Code Pride is the Best Medicine" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>