<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/documentation_options.js?v=19645805"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Categories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../category-c-and-cplusplus/">C and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-learn-to-code/">Learn to Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-math-and-math-software/">Math and Math Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-math/">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-miscellaneous/">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-newsletter/">Newsletter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-for-beginners-posts/">Python for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-functions/">Python Funcitons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-math-and-science/">Python Math and Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-practice/">Header</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-tools/">Python Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python/">Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../all_files/">Site Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/images/python-date-tutorial/index.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>Table of Contents</p>
<ul class="simple">
<li><p>Introduction</p></li>
<li><p>The DateTime Module: Basic Tasks</p>
<ul>
<li><p>How to Get the Current Time in Python</p></li>
<li><p>How to Get the Current Date in Python</p></li>
</ul>
</li>
<li><p>The Python Datetime Module: A Closer Look</p></li>
<li><p>Aware vs. Naive Datetimes</p>
<ul>
<li><p>How to Create Time Zone Aware Datetime and Time Instances</p>
<ul>
<li><p>Getting the System Time Zone</p></li>
<li><p>Creating an Arbitrary Time Zone: The Zoneinfo Module</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Getting a Future Date or Past Date in Python</p>
<ul>
<li><p>Using a Date or Datetime Constructor</p></li>
</ul>
</li>
<li><p>Manipulating Dates and Times With Timedelta</p>
<ul>
<li><p>How to Add Days to a Date Object In Python</p></li>
<li><p>Adding or Subtracting Time</p></li>
<li><p>Finding the Difference Between Two Dates</p></li>
<li><p>Calculate Remaining Days Until Christmas in Python</p></li>
</ul>
</li>
<li><p>Formatting and Parsing Dates and Times in Python</p>
<ul>
<li><p>Formatting Dates and Times with Strftime</p></li>
<li><p>Strftime Formatting Codes Review</p></li>
<li><p>Parsing Dates and Times with Strptime</p></li>
</ul>
</li>
<li><p>Saving and Parsing Dates in ISO 8601 Format</p></li>
<li><p>Date and Time Related Standard Library Modules</p>
<ul>
<li><p>The Python Calendar Module</p></li>
<li><p>The Python Time Module</p></li>
</ul>
</li>
<li><p>Dateutil: A Python Third-Party DateTime Library</p>
<ul>
<li><p>Dateutil’s General Date and Time Parser Class</p></li>
<li><p>Smart Relative Date/Time Offsets with Dateutil’s Relativedelta</p></li>
<li><p>Handling Recurring Events With Dateutil’s Rrule (Recurrence Rule)</p></li>
</ul>
</li>
<li><p>Closing Thoughts</p></li>
<li><p>You May Also Enjoy</p></li>
</ul>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h1>
<p>What time is it now?</p>
<p>That’s a pretty simple question, right? Your computer and your phone know the answer. You can probably just glance at the menu or the status bar. However, you might be surprised to learn that handling dates and times can sometimes be a bit more complex compared to simple numeric types like integers and floats. For example, how can I interpret your answer if I don’t know the time zone in which you live?</p>
<p>Fortunately, the Python standard library includes a few modules and classes to make it easy to work with dates and time values, whether they’re just local or include timezone information. For example, the Python datetime module provides an object-oriented interface to manipulate dates and times, including classes to represent differences in time between one event and another.</p>
<p>In addition to the datetime module, the timezone module allows us to work with arbitrary timezones. In contrast, the time module contains some of the functions that are useful for dealing with timezones. Finally, the calendar module lets us do some interesting things like finding out on what day of the week my birthday falls next year. (Don’t worry, you don’t have to get me anything.)</p>
<p>In this tutorial, we will discuss all of these modules, focusing on how to use the datetime module to work with dates and times. We will start with the basics, such as getting the current time and date in Python. We’ll show how, by default, the timezone information is not included, but we’ll also offer some easy methods for adding it on.</p>
<p>Then, we will move on to more advanced topics, such as working with time intervals and manipulating dates relative to the future or past. We’ll also learn how to format dates to strings and parse date strings. We’ll spend some time working on how to format and parse strings in ISO 8601 format – an international standard for representing date and time data consistently.</p>
<p>Note that our focus here will be on using dates and times generally, not for performance profiling. If you’re interested in Python features for profiling and benchmarking, please see <a class="reference external" href="https://codesolid.com/how-do-i-profile-python-code/">How to Profile Python Code</a>.</p>
<p>We’ll take it step-by-step and start with the most basic use cases first. So – if you have the time – let’s get started!</p>
</section>
<section id="the-datetime-module-basic-tasks">
<h1>The DateTime Module: Basic Tasks<a class="headerlink" href="#the-datetime-module-basic-tasks" title="Link to this heading">¶</a></h1>
<section id="how-to-get-the-current-time-in-python">
<h2>How to Get the Current Time in Python<a class="headerlink" href="#how-to-get-the-current-time-in-python" title="Link to this heading">¶</a></h2>
<p>As long as you don’t yet care about time zones, getting and displaying the current system time for the computer running the Python program is simply a matter of importing the datetime class from the datetime module and calling datetime.now().</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Display the current local time&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
</pre></div>
</div>
<p>The output will vary, of course, but currently looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2022</span>-05-25<span class="w"> </span><span class="m">17</span>:14:05.101025
</pre></div>
</div>
<p>As always with print, we see here the default string representation of a datetime object, which includes the date and time in 24-hour format, including the microseconds. We’ll get into how to format this more flexibly in a later section. For now, we’ll just point out that each of the component fields that make up this information is stored in the datetime object separately, so even given “vanilla” <a class="reference external" href="https://codesolid.com/python-format-strings/">Python string formatting techniques</a>, you can already do some work:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The time is </span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">minute</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>The<span class="w"> </span><span class="nb">time</span><span class="w"> </span>is<span class="w"> </span><span class="m">17</span>:14.
</pre></div>
</div>
</section>
<section id="how-to-get-the-current-date-in-python">
<h2>How to Get the Current Date in Python<a class="headerlink" href="#how-to-get-the-current-date-in-python" title="Link to this heading">¶</a></h2>
<p>If you’re not interested in the time, only interested in recording or displaying the current date in Python, using the datetime module’s date class is one way to get it. Instead of datetime.now(), one calls date.today() to get the current date.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the current date only</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">today</span><span class="p">)</span>
</pre></div>
</div>
<p>Output (example):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2022</span>-05-25
</pre></div>
</div>
</section>
</section>
<section id="the-python-datetime-module-a-closer-look">
<h1>The Python Datetime Module: A Closer Look<a class="headerlink" href="#the-python-datetime-module-a-closer-look" title="Link to this heading">¶</a></h1>
<p>So far, we’ve used the “<code class="docutils literal notranslate"><span class="pre">now</span></code>” function of the datetime class to get the current time, and you may have noticed this also included information about the date. We also got today’s date by calling the date class’s <code class="docutils literal notranslate"><span class="pre">&quot;today</span></code>” function. Now that we’ve touched on the very basics, it’s time to spend a little more time understanding the datetime module in more detail.</p>
<p>The datetime class can be thought of as the union of the fields from through other datetime module classes: date and time. In fact, we can get a date instance or an instance of the time class from a datetime instance. We can write a short program to display what each of these classes contains:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;datetime module basic field demo&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Get a datetime instance, and break it down into component parts</span>
<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">now_date</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">now_time</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># Show what we have:</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">now</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">now_date</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">now_time</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">825771</span><span class="p">)</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">825771</span><span class="p">)</span>
</pre></div>
</div>
<p>Here are the names of the attributes on the datetime class and their ranges. These correspond to the output showing for the datetime class above, reading the fields displayed from left to right:</p>
<ul class="simple">
<li><p>year: 1-9999</p></li>
<li><p>month: 1-12</p></li>
<li><p>day: 1 to the number of days in the month</p></li>
<li><p>hour: 0-23</p></li>
<li><p>minute: 0-59</p></li>
<li><p>second: 0-59</p></li>
<li><p>microsecond: 0-999,999</p></li>
</ul>
<p>There are no surprises here. The date class component has the year, month, and day subset of fields, while the time class component has the hour, minute, second, and microsecond.</p>
<p>There’s another field on datetime and time that’s not shown in the output above: <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code>. If this field is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, it contains information about the local time zone and its relationship to UTC (Coordinated Universal Time, also known as Greenwich Mean Time).</p>
<p>In all the code we’ve looked at so far, <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code> has been None. This means that so far, our datetime and time objects have all been limited to displaying time relative to the current computer’s time zone settings. How we can turn our dates and times into timezone-aware instances is the subject of the next section.</p>
<p>Regarding the available classes in the datetime module, we’ll focus our attention on the following classes: date, time, datetime, and timedelta. We’ve already seen three of these. The timedelta class represents time or date intervals (i.e., date and time differences).</p>
<p>The <a class="reference external" href="https://docs.python.org/3/library/datetime.html?highlight=datetime#module-datetime">Python datetime module documentation</a> has definitions of datetime.date and datetime.time that you might be interested in, especially if you work with historical dates or atomic clocks. These precise definitions are worth quoting at some length since both classes are somewhat abstracted from what we might consider their precise meanings. The datetime.date class is documented as <em>“an idealized naive date, assuming the current Gregorian calendar always was, and always will be, in effect.”</em> The datetime.time class is documented as “<em>an idealized time, independent of any particular day, assuming that every day has exactly 24*60*60 seconds. (There is no notion of ‘leap seconds’ here.)</em>”</p>
<p>For most of us who don’t care about dates that might have used the earlier Julian Calendar and who don’t need to figure out how to keep atomic clocks honest, as interesting as those details may be, you can safely ignore them in your Python program.</p>
<p>Speaking of interesting details about the Gregorian vs. Julian calendar, did you know that the first president of the United States, George Washington, had two birthdays? According to the <a class="reference external" href="https://www.archives.gov/legislative/features/washington#:~:text=George%20Washington%20was%20born%20in,days%20to%20February%2022%2C%201732.">National Archives</a>, “<em>George Washington was born in Virginia on February 11, 1731, according to the then-used Julian calendar. In 1752, however, Britain and all its colonies adopted the Gregorian calendar which moved Washington’s birthday a year and 11 days to February 22, 1732.</em>”</p>
</section>
<section id="aware-vs-naive-datetimes">
<h1>Aware vs. Naive Datetimes<a class="headerlink" href="#aware-vs-naive-datetimes" title="Link to this heading">¶</a></h1>
<p>For scripts or applications that run strictly on the desktop, local time is generally sufficient. However, there’s a large number of cases where we need to provide a date or time that includes time zone information. For example:</p>
<ul class="simple">
<li><p>You need to publish or save an exact date or time that an event occurred and share it outside your time zone.</p></li>
<li><p>You need to provide an auditing log of an event that precisely identifies when it happened, perhaps for legal or compliance reasons.</p></li>
<li><p>Your application runs on the web, and your users are distributed throughout the country or around the world.</p></li>
</ul>
<p>For this reason, the Python documentation makes a distinction between datetime and time objects that are “aware” vs. those that are “naive”. An aware instance has valid time zone information associated with it; whereas a naive object lacks it. An aware object represents a definite instance in time; a naive object is local, and valid only in the user’s time zone. The following function can be used to tell the difference if you need to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">datetime_is_aware</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns true if the timezone is present and valid. </span>
<span class="sd">         </span>
<span class="sd">         dt must be a datetime.datetime</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
<section id="how-to-create-time-zone-aware-datetime-and-time-instances">
<h2>How to Create Time Zone Aware Datetime and Time Instances<a class="headerlink" href="#how-to-create-time-zone-aware-datetime-and-time-instances" title="Link to this heading">¶</a></h2>
<section id="getting-the-system-time-zone">
<h3>Getting the System Time Zone<a class="headerlink" href="#getting-the-system-time-zone" title="Link to this heading">¶</a></h3>
<p>Fortunately, creating instances that are time zone aware is quite easy to do in Python. Simply call the datetime function <code class="docutils literal notranslate"><span class="pre">astimezone</span></code> on a naive instance to return an aware datetime instance. With the function above to check our result, here’s a short example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Naive datetimes vs aware datetimes&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">dt_naive</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">dt_aware</span> <span class="o">=</span> <span class="n">dt_naive</span><span class="o">.</span><span class="n">astimezone</span><span class="p">()</span>
<span class="n">time_zone</span> <span class="o">=</span> <span class="n">dt_aware</span><span class="o">.</span><span class="n">tzinfo</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dt_aware is aware ? </span><span class="si">{</span><span class="n">datetime_is_aware</span><span class="p">(</span><span class="n">dt_aware</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dt_naive is aware ? </span><span class="si">{</span><span class="n">datetime_is_aware</span><span class="p">(</span><span class="n">dt_naive</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">dt_aware</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dt_aware<span class="w"> </span>is<span class="w"> </span>aware<span class="w"> </span>?<span class="w"> </span>True
dt_naive<span class="w"> </span>is<span class="w"> </span>aware<span class="w"> </span>?<span class="w"> </span>False
datetime.datetime<span class="o">(</span><span class="m">2022</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">26</span>,<span class="w"> </span><span class="m">18</span>,<span class="w"> </span><span class="m">13</span>,<span class="w"> </span><span class="m">12</span>,<span class="w"> </span><span class="m">285527</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>datetime.timezone<span class="o">(</span>datetime.timedelta<span class="o">(</span><span class="nv">days</span><span class="o">=</span>-1,<span class="w"> </span><span class="nv">seconds</span><span class="o">=</span><span class="m">72000</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;EDT&#39;</span><span class="o">))</span>
</pre></div>
</div>
<p>To get a timezone aware instance representing the current time, you first need to call <code class="docutils literal notranslate"><span class="pre">astimezone</span></code> on the datetime instance so that the instance itself is timezone aware, then call <code class="docutils literal notranslate"><span class="pre">timetz</span></code> on the result.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Get a timezone aware time object&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">my_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">astimezone</span><span class="p">()</span><span class="o">.</span><span class="n">timetz</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">my_time</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>datetime.time<span class="o">(</span><span class="m">12</span>,<span class="w"> </span><span class="m">45</span>,<span class="w"> </span><span class="m">12</span>,<span class="w"> </span><span class="m">544156</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>datetime.timezone<span class="o">(</span>datetime.timedelta<span class="o">(</span><span class="nv">days</span><span class="o">=</span>-1,<span class="w"> </span><span class="nv">seconds</span><span class="o">=</span><span class="m">72000</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;EDT&#39;</span><span class="o">))</span>
</pre></div>
</div>
</section>
<section id="creating-an-arbitrary-time-zone-the-zoneinfo-module">
<h3>Creating an Arbitrary Time Zone: The Zoneinfo Module<a class="headerlink" href="#creating-an-arbitrary-time-zone-the-zoneinfo-module" title="Link to this heading">¶</a></h3>
<p>In the previous section, we created timezone-aware datetime and time instances using the <code class="docutils literal notranslate"><span class="pre">astimezone</span></code> method of the datetime class. This is a simple and reliable way to get the time zone of the computer the code you’re running on.</p>
<p>Occasionally, however, you might need to be able to create an arbitrary time zone instance. Suppose your main data center is on the Island of Guam. You’ve been asked to ensure that your web application always writes timezone-aware dates and times to the log, in Guam local time, even if you’re testing from a machine in Saluda, North Carolina.</p>
<p>To accomplish this you would need to step outside the datetime module we’ve been dealing with so far, and start using the zoneinfo module. The zoneinfo module’s ZoneInfo class provides a way to create time zone information objects compatible with datetime.tzinfo. You do this by passing a name we can use as a key into the IANA time zone database. (By the way, in addition to the <a class="reference external" href="https://www.iana.org/time-zones">time zone database</a>, IANA, or Internet Assigned Numbers Authority, is the same group that maintains the root DNS zones and many other registries used in internet protocols.)</p>
<p>To use the database, our first task is to find a name that seems to be about Guam that we can use. We can write a short snippet of code to get a set of available names using zoneinfo’s <code class="docutils literal notranslate"><span class="pre">available_timezones</span></code> function, to see if we can scare up a string that will work for Guam:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Lookup Guam&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">zoneinfo</span>
<span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">zoneinfo</span><span class="o">.</span><span class="n">available_timezones</span><span class="p">():</span>
    <span class="k">if</span> <span class="s2">&quot;Guam&quot;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Pacific/Guam
</pre></div>
</div>
<p>Well, that worked well, let’s write some exploratory code to make sure we’re on the right track:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tz_guam</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;Pacific/Guam&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">tz_guam</span><span class="p">))</span>

<span class="c1"># Given a datetime object, we can also look at Guam&#39;s offset from UTC:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tz_guam</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>zoneinfo.ZoneInfo<span class="o">(</span><span class="nv">key</span><span class="o">=</span><span class="s1">&#39;Pacific/Guam&#39;</span><span class="o">)</span>
<span class="m">10</span>:00:00
</pre></div>
</div>
<p>OK, that makes sense, Guam is out in the Pacific north of eastern Australia, so the clocks run ten hours ahead of UTC (Greenwich, England).</p>
<p>Let’s see how it compares to our machine in Saluda, North Carolina. In the example below, we see <code class="docutils literal notranslate"><span class="pre">astimezone</span></code> used as we’ve already used it, to <em>get</em> the local machine’s time zone into a datetime instance, but we see we can also use it to <em>set</em> an arbitrary timezone on the resulting datetime. That’s a subtle point that’s worth noting. It’s not an easy design to remember, perhaps, but it makes the code very concise.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the current time, using the machine&#39;s local time zone (Eastern Daylight Time)</span>

<span class="n">now_here</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">astimezone</span><span class="p">()</span>
<span class="n">now_guam</span> <span class="o">=</span> <span class="n">now_here</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">tz_guam</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">now_here</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">now_guam</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>datetime.datetime<span class="o">(</span><span class="m">2022</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">27</span>,<span class="w"> </span><span class="m">17</span>,<span class="w"> </span><span class="m">31</span>,<span class="w"> </span><span class="m">53</span>,<span class="w"> </span><span class="m">744449</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>datetime.timezone<span class="o">(</span>datetime.timedelta<span class="o">(</span><span class="nv">days</span><span class="o">=</span>-1,<span class="w"> </span><span class="nv">seconds</span><span class="o">=</span><span class="m">72000</span><span class="o">)</span>,<span class="w"> </span><span class="s1">&#39;EDT&#39;</span><span class="o">))</span>
datetime.datetime<span class="o">(</span><span class="m">2022</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">31</span>,<span class="w"> </span><span class="m">53</span>,<span class="w"> </span><span class="m">744449</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>zoneinfo.ZoneInfo<span class="o">(</span><span class="nv">key</span><span class="o">=</span><span class="s1">&#39;Pacific/Guam&#39;</span><span class="o">))</span>
</pre></div>
</div>
<p>Alright, let’s see. It’s 5:31 PM on May 27th here in North Carolina, and in Guam, it’s already tomorrow at 7:31 AM. Currently, Eastern Daylight Time is UTC-4, and we learned earlier that Guam is UTC+10. Sure enough, 7:31 AM tomorrow is 14 hours ahead of 5:31 today.</p>
<p>With the Guam time zone as a module constant somewhere, our routine to get a current time object for the log (always relative to Guam), is quite simple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the current time in Guam:</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">zoneinfo</span> <span class="kn">import</span> <span class="n">ZoneInfo</span>

<span class="n">TZ_GUAM</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;Pacific/Guam&quot;</span><span class="p">)</span>

<span class="c1"># ...</span>

<span class="k">def</span> <span class="nf">guam_now</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">TZ_GUAM</span><span class="p">)</span>
</pre></div>
</div>
<p>That turned out to be super simple, but we should make a mental note to ask the boss how our data centers ended up in Guam.</p>
</section>
</section>
</section>
<section id="getting-a-future-date-or-past-date-in-python">
<h1>Getting a Future Date or Past Date in Python<a class="headerlink" href="#getting-a-future-date-or-past-date-in-python" title="Link to this heading">¶</a></h1>
<p>So far we’ve been incredibly zen in our approach to dates and times: we live always in the present moment. Yes, we seemed to get a time in the “future” when Guam was fourteen hours ahead of us, but no, that was just “right now” in another time zone.</p>
<section id="using-a-date-or-datetime-constructor">
<h2>Using a Date or Datetime Constructor<a class="headerlink" href="#using-a-date-or-datetime-constructor" title="Link to this heading">¶</a></h2>
<p>To construct future dates or datetime objects, we simply pass the fields we discussed earlier into the appropriate constructor. For datetime, we can specify the <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code> field if we wish, and we have to pass the date fields (the time fields are optional).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the date and datetime constructors</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">zoneinfo</span> <span class="kn">import</span> <span class="n">ZoneInfo</span>

<span class="n">independence_day</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">1776</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># A date that will live in infamy:</span>
<span class="n">pearl_harbor</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1941</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">pearl_harbor_more_exactly</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1941</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;Pacific/Honolulu&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">independence_day</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pearl_harbor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pearl_harbor_more_exactly</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1776</span>-07-04
<span class="m">1941</span>-12-07<span class="w"> </span><span class="m">00</span>:00:00
<span class="m">1941</span>-12-07<span class="w"> </span><span class="m">07</span>:55:00-10:30
</pre></div>
</div>
<p>That “-10:30” part of the last line is the offset for Hawaii from UTC, ten and one-half hours (according to IANA, at least). Most of the other documentation I’ve seen shows it should be -10:00.</p>
<p>See the next section for another way to get past and future dates.</p>
</section>
</section>
<section id="manipulating-dates-and-times-with-timedelta">
<h1>Manipulating Dates and Times With Timedelta<a class="headerlink" href="#manipulating-dates-and-times-with-timedelta" title="Link to this heading">¶</a></h1>
<section id="how-to-add-days-to-a-date-object-in-python">
<h2>How to Add Days to a Date Object In Python<a class="headerlink" href="#how-to-add-days-to-a-date-object-in-python" title="Link to this heading">¶</a></h2>
<p>Besides using a constructor, we can use the datetime module’s <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> class to get an arbitrary date or time in the future or the past. The <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> class represents the difference between two dates or times. For example, let’s say you’re a library writing a custom application to track when a book will be due. You can add fourteen or twenty-one days to today’s date, and easily get the resulting date.</p>
<p>You generally construct a <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> object using either days or seconds as a value. (You can also use both). Either value can be positive or negative. Here are some <code class="docutils literal notranslate"><span class="pre">timedelta</span></code> examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Constructing a Python timedelta object&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>

<span class="c1"># 22 minutes from now</span>
<span class="n">td1</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">22</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">td1</span><span class="p">)</span>

<span class="c1"># 14 days ago</span>
<span class="n">td2</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=-</span><span class="mi">14</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">td2</span><span class="p">)</span>

<span class="c1"># 46 hours from now (2 days minus two hours)</span>
<span class="n">td3</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=-</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">td3</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">00</span>
<span class="o">-</span><span class="mi">14</span> <span class="n">days</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="mi">1</span> <span class="n">day</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</pre></div>
</div>
<p>With that knowledge, we can easily write our simple library due-date program:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Using timedelta to calculate a due date&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">datetime</span>

<span class="n">LOAN_PERIOD_DAYS</span> <span class="o">=</span> <span class="mi">21</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">due_date</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">LOAN_PERIOD_DAYS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Today is </span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s2">.  Your book is due on </span><span class="si">{</span><span class="n">due_date</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Today<span class="w"> </span>is<span class="w"> </span><span class="m">2022</span>-05-28.<span class="w"> </span>Your<span class="w"> </span>book<span class="w"> </span>is<span class="w"> </span>due<span class="w"> </span>on<span class="w"> </span><span class="m">2022</span>-06-18.
</pre></div>
</div>
</section>
<section id="adding-or-subtracting-time">
<h2>Adding or Subtracting Time<a class="headerlink" href="#adding-or-subtracting-time" title="Link to this heading">¶</a></h2>
<p>The same technique can be used to apply a time difference, too, of course. And remember we can always move dates and times ahead as well as behind.</p>
<p>There is a caveat when adding or subtracting times. Unlike adding or subtracting date objects, which we saw above uses simple math operators, in the case of <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code>, the + and - operators are not overloaded. So time intervals can not be added or subtracted on time objects. So the way you have to do it is to add or subtract the time interval you want to the datetime object first, then use the datetime object’s <code class="docutils literal notranslate"><span class="pre">time</span></code> function to return just the time if that’s what you want.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Travel 3 minutes into the past:</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="n">MINUTES_AGO</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">earlier</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span> <span class="o">=</span> <span class="n">MINUTES_AGO</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Now it&#39;s </span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="si">}</span><span class="s2">. Three minutes ago it was </span><span class="si">{</span><span class="n">earlier</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="si">}</span><span class="s2">.  See you there!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Now<span class="w"> </span>it<span class="err">&#39;</span>s<span class="w"> </span><span class="m">16</span>:11:11.562711.<span class="w"> </span>Three<span class="w"> </span>minutes<span class="w"> </span>ago<span class="w"> </span>it<span class="w"> </span>was<span class="w"> </span><span class="m">16</span>:08:11.562711.<span class="w"> </span>See<span class="w"> </span>you<span class="w"> </span>there!
</pre></div>
</div>
<p>Again, we’ll focus on getting some prettier formatting going in a later section. For now, let’s continue our discussion of the Python timedelta class.</p>
</section>
<section id="finding-the-difference-between-two-dates">
<h2>Finding the Difference Between Two Dates<a class="headerlink" href="#finding-the-difference-between-two-dates" title="Link to this heading">¶</a></h2>
<p>So far we’ve looked at how to construct a timedelta object using either days or seconds and use it to adjust a date into either the future or the past. So we’ve seen basically this formula at work (pseudocode):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>datetime_1<span class="w"> </span>+/-<span class="w"> </span><span class="nv">timedelta</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>datetime_2<span class="w"> </span>
</pre></div>
</div>
<p>If this were simple algebra, it would also stand to reason that we could move terms around to get something like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>datetime_1<span class="w"> </span>-<span class="w"> </span><span class="nv">datetime_2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>timedelta
</pre></div>
</div>
<p>So you might be wondering, “Does that also work in Python?” The answer to that question is that it sure does, and we can use this property to implement behavior such as a countdown timer or calendar.</p>
</section>
<section id="calculate-remaining-days-until-christmas-in-python">
<h2>Calculate Remaining Days Until Christmas in Python<a class="headerlink" href="#calculate-remaining-days-until-christmas-in-python" title="Link to this heading">¶</a></h2>
<p>Now that we know that subtracting dates or datetimes will return a timedelta object, let’s work a fun program with it.</p>
<p>If your kids need to know when Santa will be here, here’s how you could do it. (Apologies in advance to those who don’t celebrate that particular winter holiday, but feel free to adapt the code!).</p>
<p>ou’ll notice we’ll also do a datetime comparison in this program; we’ll explain it all after showing the code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="k">def</span> <span class="nf">get_christmas_year</span><span class="p">(</span><span class="n">today</span><span class="p">:</span> <span class="n">date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The next Christmas will usually be this year, but not between Christmas and New Year&#39;s&quot;&quot;&quot;</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">today</span><span class="o">.</span><span class="n">year</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">12</span> <span class="ow">and</span> <span class="n">today</span><span class="o">.</span><span class="n">day</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="k">else</span> <span class="n">today</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">year</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="n">christmas</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="n">get_christmas_year</span><span class="p">(</span><span class="n">today</span><span class="p">),</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">days_till_christmas</span> <span class="o">=</span> <span class="n">christmas</span> <span class="o">-</span> <span class="n">today</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Today is </span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s2">. Christmas is </span><span class="si">{</span><span class="n">christmas</span><span class="si">}</span><span class="s2">, which will be in </span><span class="si">{</span><span class="n">days_till_christmas</span><span class="o">.</span><span class="n">days</span><span class="si">}</span><span class="s2"> days.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Since this code is more important than the usual code I post (ask anyone under 12 years old), we’ll depart from the our usual formatting practice a bit and show the results as of today from repl.it.</p>
<iframe frameborder="0" width="100%" height="500px" src="https://replit.com/@Johnsin/DaysUntilChristmas?lite=true"></iframe>
</section>
</section>
<section id="formatting-and-parsing-dates-and-times-in-python">
<h1>Formatting and Parsing Dates and Times in Python<a class="headerlink" href="#formatting-and-parsing-dates-and-times-in-python" title="Link to this heading">¶</a></h1>
<p>If you’ve been reading through the article so far, you may have noticed that many of our “output” sections have been rather ugly. For example, in our section on “Adding or Subtracting Time”, the output from one of our examples was this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Now<span class="w"> </span>it<span class="err">&#39;</span>s<span class="w"> </span><span class="m">16</span>:11:11.562711.<span class="w"> </span>Three<span class="w"> </span>minutes<span class="w"> </span>ago<span class="w"> </span>it<span class="w"> </span>was<span class="w"> </span><span class="m">16</span>:08:11.562711.<span class="w"> </span>See<span class="w"> </span>you<span class="w"> </span>there!
</pre></div>
</div>
<p>Fortunately, by digging into the datetime module a bit more, we can improve on this quite a bit.</p>
<p>The classes in the datetime module have two important functions, <code class="docutils literal notranslate"><span class="pre">strftime</span></code> and <code class="docutils literal notranslate"><span class="pre">strptime</span></code>. At a high level, those functions can be described as follows:</p>
<ul class="simple">
<li><p><strong>strftime</strong> is an instance method on the date, time, and datetime classes. Its purpose is to convert the object to a string using special formatting codes that allow much more precise control than the default format from __repr__ or __str__.</p></li>
<li><p><strong>strptime</strong> is a class method, so you don’t need an object instance. It is only defined on the datetime class. Its purpose is to be able to flexibly parse a string to a datetime instance. As we’ve already seen, from there you can, if desired, obtain simply the time or date portion as a date or time instance.</p></li>
</ul>
<p>As a Python programmer, you may find those names a little bit more compressed than what you’re used to. The names actually come from the same functions in C, the language on which Python is based. Their shortness reflects the fact that, prior to the 1989 ANSI C standard, some C compilers only supported identifiers up to eight characters in length!</p>
<p>Strftime and strptime share the same <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes">formatting codes</a>. As with everything in Python, however, the best way to get a feel for them is by coding up several examples.</p>
<section id="formatting-dates-and-times-with-strftime">
<h2>Formatting Dates and Times with Strftime<a class="headerlink" href="#formatting-dates-and-times-with-strftime" title="Link to this heading">¶</a></h2>
<p>We’ll start with some formatting examples with strftime. Since we’ll need a date and time for the example, I’m going to choose a day that’s special for me, narrow the time down as much as I can, and throw a Hail Mary pass on the microseconds.</p>
<p>So here we go:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">zoneinfo</span> <span class="kn">import</span> <span class="n">ZoneInfo</span>

<span class="n">california</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;America/Los_Angeles&quot;</span><span class="p">)</span>
<span class="n">special_day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123456</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">california</span><span class="p">)</span>

<span class="c1"># Get the sub-objects, or we could have used the original datetime </span>
<span class="c1"># instead for these examples</span>
<span class="n">special_date</span> <span class="o">=</span> <span class="n">special_day</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">special_time</span> <span class="o">=</span> <span class="n">special_day</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="c1"># What day of the week was John&#39;s special day?  </span>
<span class="c1"># Please not Monday... Please not Monday...</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y was a %A.&quot;</span><span class="p">))</span>

<span class="c1"># %I lets us work with a 12 hour clock</span>
<span class="c1"># %p gives us AM or PM equivalent in our current locale.</span>
<span class="c1"># What time was our big event?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;The big event took place around %I:%M %p.&quot;</span><span class="p">))</span>

<span class="c1"># More fun facts</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special_day</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;In terms of %Y, %b </span><span class="si">%d</span><span class="s2"> was day number %j.&quot;</span><span class="p">))</span>

<span class="c1"># Where was it?</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special_day</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;The event took place in timezone at UTC%z.&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>October<span class="w"> </span><span class="m">01</span>,<span class="w"> </span><span class="m">2011</span><span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>Saturday.
The<span class="w"> </span>big<span class="w"> </span>event<span class="w"> </span>took<span class="w"> </span>place<span class="w"> </span>around<span class="w"> </span><span class="m">10</span>:45<span class="w"> </span>AM.
In<span class="w"> </span>terms<span class="w"> </span>of<span class="w"> </span><span class="m">2011</span>,<span class="w"> </span>Oct<span class="w"> </span><span class="m">01</span><span class="w"> </span>was<span class="w"> </span>day<span class="w"> </span>number<span class="w"> </span><span class="m">274</span>.
The<span class="w"> </span>event<span class="w"> </span>took<span class="w"> </span>place<span class="w"> </span><span class="k">in</span><span class="w"> </span>timezone<span class="w"> </span>at<span class="w"> </span>UTC-0700.
</pre></div>
</div>
</section>
<section id="strftime-formatting-codes-review">
<h2>Strftime Formatting Codes Review<a class="headerlink" href="#strftime-formatting-codes-review" title="Link to this heading">¶</a></h2>
<p>Let’s review the formatting codes we used to get these four lines of output (lines 14, 19, 22, and 25).</p>
<p>For line 14:</p>
<ul class="simple">
<li><p><strong>%B</strong> The full month name for the current locale.</p></li>
<li><p><strong>%d</strong> Day of the month, zero-padded to two digits. (We’ll show how to get rid of the zero-padding below)</p></li>
<li><p><strong>%Y</strong> Four-digit year.</p></li>
<li><p><strong>%A</strong> Full day of week name for the current locale.</p></li>
</ul>
<p>The issue of strftime and strptime not having a one-digit day of the month code is easily fixed at least on the output side by mixing in a little modern f-string magic. I found it easy to mix f-strings and strftime format strings, at least in this case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Mixing f-strings and strftime format strings&quot;&quot;&quot;</span>
<span class="c1"># Output:  October 1, 2011 was a Saturday.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">special_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%B </span><span class="si">{</span><span class="n">special_date</span><span class="o">.</span><span class="n">day</span><span class="si">}</span><span class="s2">, %Y was a %A.&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>For more on Python f-strings, see <a class="reference external" href="https://codesolid.com/python-format-strings/">Python Format Strings: Beginner to Expert</a>.</p>
<p>Continuing our review of the format codes we used, on line 19:</p>
<ul class="simple">
<li><p><strong>%I</strong> Hour, zero padded to two digits if need be, beginning with 00 for midnight.</p></li>
<li><p><strong>%M</strong> Minutes, zero padded to two digits.</p></li>
<li><p><strong>%p</strong> Equivalent of “AM” or “PM” for the current locale.</p></li>
</ul>
<p>By line 22, we’re starting to repeat ourselves a bit, but the new format codes here are:</p>
<ul class="simple">
<li><p><strong>%b</strong> Short name for month (recall that we used <strong>%B</strong> for the full name above). In English, short names are “Jan”, “Feb”, etc.</p></li>
<li><p><strong>%j</strong> Just for fun, the number of the day in the year. I say “just for fun because you probably won’t need it often.”</p></li>
</ul>
<p>Line 25 contains only one code, a UTC offset, a precise value beginning with +/-HHHH, e.g. -0700 (seven hours behind), +1030 (ten and a half hours ahead), etc.</p>
</section>
<section id="parsing-dates-and-times-with-strptime">
<h2>Parsing Dates and Times with Strptime<a class="headerlink" href="#parsing-dates-and-times-with-strptime" title="Link to this heading">¶</a></h2>
<p>The Python datetime class has a static method, strptime, that can be used to flexibly parse datetimes. It accepts a two arguments, a string representing a date, and a format string representing how to parse it. The format strings are compatible with strftime, however, strptime will set some defaults if parts of a full datetime are not available, as follows:</p>
<ul class="simple">
<li><p>If you pass a format string that will only retrieve the time portion, the date will be set to January 1, 1900.</p></li>
<li><p>If you pass a format string that will only retrieve the date fortune, the time will be set to the earliest date possible on that day (i.e. midnight, or 00:00).</p></li>
</ul>
<p>From what I’ve seen, it’ll also select defaults in other positions, for example, only an hour will set the minutes to zero, but I haven’t tried every possible combination.</p>
<p>A simple example can show strptime in action.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Simple strptime example&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">date_string</span> <span class="o">=</span> <span class="s2">&quot;Saturday, October 01, 2011&quot;</span>
<span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;%A, %B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span>
<span class="n">parsed</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_string</span><span class="p">,</span> <span class="n">format_string</span><span class="p">)</span>
<span class="n">date_string2</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">format_string</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">date_string</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">date_string2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Saturday</span><span class="p">,</span> <span class="n">October</span> <span class="mi">01</span><span class="p">,</span> <span class="mi">2011</span>
<span class="n">Saturday</span><span class="p">,</span> <span class="n">October</span> <span class="mi">01</span><span class="p">,</span> <span class="mi">2011</span>
<span class="mi">2011</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</pre></div>
</div>
<p>In this example, we demonstrate the compatibility of strptime and strftime by reading a datetime from a string using strptime formating (at line 7), and parsing the datetime back out to a string using the same format string (line 8). On lines 10-12, we show the strings to show that they’re identical, then display the datetime using the default format.</p>
</section>
</section>
<section id="saving-and-parsing-dates-in-iso-8601-format">
<h1>Saving and Parsing Dates in ISO 8601 Format<a class="headerlink" href="#saving-and-parsing-dates-in-iso-8601-format" title="Link to this heading">¶</a></h1>
<p>The datetime module provides limited support for formatting and parsing dates in ISO 8601 format. For example, the datetime class can format a string to ISO 8601 format using the <code class="docutils literal notranslate"><span class="pre">isoformat</span></code> method. The <code class="docutils literal notranslate"><span class="pre">fromisoformat</span></code> can parse such a string back to a datetime object, however, the Python documentation warns against using it to parse <em>arbitrary</em> ISO 8601 strings that weren’t created by the <code class="docutils literal notranslate"><span class="pre">isoformat</span></code>. (For those use cases, it recommends using the third party module, dateutil, which we’ll discuss below).</p>
<p>Meantime, since the datetime library in core Python is fine if you control both the strings created and the parsing side, let’s show a quick example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;datetime ISO format handling demo&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">zoneinfo</span> <span class="kn">import</span> <span class="n">ZoneInfo</span>

<span class="n">california</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;America/Los_Angeles&quot;</span><span class="p">)</span>
<span class="n">special_day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123456</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">california</span><span class="p">)</span>

<span class="c1"># Format</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">special_day</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

<span class="c1"># Parse</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2011</span>-10-01T10:45:00.123456-07:00
<span class="m">2011</span>-10-01<span class="w"> </span><span class="m">10</span>:45:00.123456-07:00
</pre></div>
</div>
</section>
<section id="date-and-time-related-standard-library-modules">
<h1>Date and Time Related Standard Library Modules<a class="headerlink" href="#date-and-time-related-standard-library-modules" title="Link to this heading">¶</a></h1>
<p>In addition to the datetime and zoneinfo modules, there are two related modules in the Python standard library.</p>
<section id="the-python-calendar-module">
<h2>The Python Calendar Module<a class="headerlink" href="#the-python-calendar-module" title="Link to this heading">¶</a></h2>
<p>The calendar module has several calendar-related functions. For example, you can print a text-based calendar for a given month or year. If I wanted to see a calendar for the month Colombia declared its independence from Spain (July 1810), it’s easily accomplished using the TextCalendar’s “prmonth “(“print month”) function:</p>
<p><img alt="" src="../../_images/image-95.png" /></p>
<p>If you need your calendars in HTML format, with some control over the CSS class names to use for the various pieces, the HTMLCalendar class gets you there.</p>
</section>
<section id="the-python-time-module">
<h2>The Python Time Module<a class="headerlink" href="#the-python-time-module" title="Link to this heading">¶</a></h2>
<p>The Python time module provides several time functions that are based on – and generally, call into – their equivalent functions in C. Because of this dependency on the underlying C code, the behavior of some of these functions is different on different platforms. Indeed, a number of these functions are only available on Unix (and presumably, by extension, on Linux and Mac).</p>
<p>That said, on certain platforms, high-precision time readings are available in this module. Moreover, there is one function that’s useful on many platforms: <code class="docutils literal notranslate"><span class="pre">time.sleep</span></code>, which takes a floating-point value representing a fractional or whole number of seconds. This function suspends the execution of the current thread for that time.</p>
</section>
</section>
<section id="dateutil-a-python-third-party-datetime-library">
<h1>Dateutil: A Python Third-Party DateTime Library<a class="headerlink" href="#dateutil-a-python-third-party-datetime-library" title="Link to this heading">¶</a></h1>
<p>Dateutil is a powerful and popular third-part extension to the Python datetime module. It is mentioned several times in the Python standard library documentation on datetime.</p>
<p>Like almost all third-party libraries, you can install it using pip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>python-dateutil
</pre></div>
</div>
<p>Some of its main features are:</p>
<ul class="simple">
<li><p>More flexible ISO 8601 date parsing than the standard library <code class="docutils literal notranslate"><span class="pre">datetime.fromisoformat</span></code> function.</p></li>
<li><p>Another flexible parser that can “understand” many non-standard date formats, with some very intelligent defaults.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">relativedelta</span></code> class that lets you specify time differences in many ways that are easier to use and more “calendar-aware” than datetime.timedelta.</p></li>
<li><p>A recurrence rule class (<code class="docutils literal notranslate"><span class="pre">rrule</span></code>) that can be used to schedule a series of events as you might see in a calendar application like Google Calendar or Outlook.</p></li>
</ul>
<p>In general terms, the difference between Python’s datetime module and the third-party dateutil module is that datetime tends to do things in a way that is explicit and precise, but less flexible and less “calendar-aware”. The dateutil module, in contrast, is generally more flexible and can do things less explicitly (in the case of parsing), using somewhat more useful defaults for some values.</p>
<p>Let’s take a look at a few of the classes provided by the dateutil module to get a feel for them in action.</p>
<section id="dateutil-s-general-date-and-time-parser-class">
<h2>Dateutil’s General Date and Time Parser Class<a class="headerlink" href="#dateutil-s-general-date-and-time-parser-class" title="Link to this heading">¶</a></h2>
<p>In our discussion of Python datetime’s <code class="docutils literal notranslate"><span class="pre">strptime</span></code> function, we showed how <code class="docutils literal notranslate"><span class="pre">strptime</span></code> could be used to parse dates and times using format strings that are compatible with those used in <code class="docutils literal notranslate"><span class="pre">strftime</span></code>. Having to provide the format codes explicitly gives precise control over how a date gets parsed, but in contrast, the dateutil.parser module does an excellent job of parsing arbitrary dates without a formatting string. Simply pass the string containing the date or time to the parse function, and most of the time, it will do the right thing.</p>
<p>In the following code, we show today’s date. We then use a list of date strings, and pass each one to “parse”, building a table of the examples and the resultant parsed datetime object. The core of it (boiled down), is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil</span> <span class="kn">import</span> <span class="n">parser</span>
<span class="c1"># ...</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Demonstrates dateutil&#39;s flexible parse method&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">dateutil</span> <span class="kn">import</span> <span class="n">parser</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Today is </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;December 7, 1941&quot;</span><span class="p">,</span> <span class="s2">&quot;2010-05-22&quot;</span><span class="p">,</span> <span class="s2">&quot;10:22 AM&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;Wednesday at 4:00 PM&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;EXAMPLE: &#39;</span><span class="si">}{</span><span class="s1">&#39;PARSED:&#39;</span><span class="w"> </span><span class="si">:</span><span class="s2"> &gt;21</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
    <span class="n">parsed</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">example</span><span class="w"> </span><span class="si">:</span><span class="s2"> &lt;22</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">parsed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Today<span class="w"> </span>is<span class="w"> </span><span class="m">2022</span>-05-31

EXAMPLE:<span class="w">               </span>PARSED:
------------------------------------------
December<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">1941</span><span class="w">       </span><span class="m">1941</span>-12-07<span class="w"> </span><span class="m">00</span>:00:00
<span class="m">2010</span>-05-22<span class="w">             </span><span class="m">2010</span>-05-22<span class="w"> </span><span class="m">00</span>:00:00
<span class="m">10</span>:22<span class="w"> </span>AM<span class="w">               </span><span class="m">2022</span>-05-31<span class="w"> </span><span class="m">10</span>:22:00
Wednesday<span class="w"> </span>at<span class="w"> </span><span class="m">4</span>:00<span class="w"> </span>PM<span class="w">   </span><span class="m">2022</span>-06-01<span class="w"> </span><span class="m">16</span>:00:00
</pre></div>
</div>
<p>Looking at the table of output, the first two lines are interesting to the extent that they are very different date strings, and the parse method handled them both without an explicit format string to tell it what to do. The third line of the table shows that – unlike strptime – time strings without date information are interpreted to be a time happening today, which is probably a much more reasonable default for what most of us mean by “at 2:30”, for example. In the final line, We see Wednesday at 4:00 PM gets interpreted to mean “the next Wednesday relative to today”, which in this case is June 1st (tomorrow, as I run this).</p>
<p>This is a very nice result for a parser where we don’t need to specify a format string upfront for every possibility. The tradeoff for this convenience is that such a parser probably takes more clock cycles to run than strptime, so it may not be a great fit for parsing a large series of values in a known format.</p>
</section>
<section id="smart-relative-date-time-offsets-with-dateutil-s-relativedelta">
<h2>Smart Relative Date/Time Offsets with Dateutil’s Relativedelta<a class="headerlink" href="#smart-relative-date-time-offsets-with-dateutil-s-relativedelta" title="Link to this heading">¶</a></h2>
<p>As we’ve seen in an earlier section, Python’s datetime module has a timedelta class that allows us to specify a time offset, generally either in seconds or days. This is useful in some cases, but consider the case where you want two months from now to map to the same date of the month, or the “end of the month” if you call it on the 31st. Doing that manually using days would require a table of months to days in the month, knowing about leap years, etc.</p>
<p>Here again, the dateutil module provides a solution that’s far more flexible. In the code below, for example, we use the <code class="docutils literal notranslate"><span class="pre">relativedelta</span></code> class to calculate some date offsets in terms of weeks and months.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Using dateutil&#39;s relativedelta class&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">dateutil.relativedelta</span> <span class="kn">import</span> <span class="n">relativedelta</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

<span class="n">one_month_from_now</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">today</span><span class="p">,</span> <span class="n">months</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">six_weeks_ago</span> <span class="o">=</span> <span class="n">today</span> <span class="o">+</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">today</span><span class="p">,</span> <span class="n">weeks</span><span class="o">=-</span><span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Today is </span><span class="si">{</span><span class="n">today</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;One month from now = </span><span class="si">{</span><span class="n">one_month_from_now</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Six weeks ago was </span><span class="si">{</span><span class="n">six_weeks_ago</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Today is a </span><span class="si">{</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%A&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">, six weeks ago was a </span><span class="si">{</span><span class="n">six_weeks_ago</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%A&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Today<span class="w"> </span>is<span class="w"> </span><span class="m">2022</span>-05-31.
One<span class="w"> </span>month<span class="w"> </span>from<span class="w"> </span><span class="nv">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2022</span>-06-30.
Six<span class="w"> </span>weeks<span class="w"> </span>ago<span class="w"> </span>was<span class="w"> </span><span class="m">2022</span>-04-19.
Today<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>Tuesday,<span class="w"> </span>six<span class="w"> </span>weeks<span class="w"> </span>ago<span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>Tuesday.
</pre></div>
</div>
</section>
<section id="handling-recurring-events-with-dateutil-s-rrule-recurrence-rule">
<h2>Handling Recurring Events With Dateutil’s Rrule (Recurrence Rule)<a class="headerlink" href="#handling-recurring-events-with-dateutil-s-rrule-recurrence-rule" title="Link to this heading">¶</a></h2>
<p>For our last DateUtil example, let’s take a look at how we might code a series of recurring events, similar to what you might do when you schedule a repeating meeting in Outlook:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;dateutil example, repeating an date five times beginning with today&#39;s date&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">dateutil.rrule</span> <span class="kn">import</span> <span class="n">rrule</span><span class="p">,</span> <span class="n">WEEKLY</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
<span class="n">days</span> <span class="o">=</span> <span class="n">rrule</span><span class="p">(</span><span class="n">WEEKLY</span><span class="p">,</span> <span class="n">dtstart</span><span class="o">=</span><span class="n">today</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">day</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B </span><span class="si">%d</span><span class="s2">, %Y&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>May<span class="w"> </span><span class="m">31</span>,<span class="w"> </span><span class="m">2022</span>
June<span class="w"> </span><span class="m">07</span>,<span class="w"> </span><span class="m">2022</span>
June<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">2022</span>
June<span class="w"> </span><span class="m">21</span>,<span class="w"> </span><span class="m">2022</span>
June<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">2022</span>
</pre></div>
</div>
</section>
</section>
<section id="closing-thoughts">
<h1>Closing Thoughts<a class="headerlink" href="#closing-thoughts" title="Link to this heading">¶</a></h1>
<p>As we’ve seen, the Python ecosystem contains a number of built-in and third-party classes that make date and time handling convenient and reliable. We hope the many examples in this tutorial have given you some ideas that you can use right away in your code!</p>
</section>
<section id="you-may-also-enjoy">
<h1>You May Also Enjoy<a class="headerlink" href="#you-may-also-enjoy" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://codesolid.com/python-format-strings/">Python Format Strings: Beginner to Expert</a></p>
<p><a class="reference external" href="https://codesolid.com/python-operators/">Python Operators: The Building Blocks of Successful Code</a></p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>