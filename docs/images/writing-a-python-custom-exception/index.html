<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Custom Exceptions &mdash; CodeSolid.com 0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/documentation_options.js?v=19645805"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            CodeSolid.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Featured Articles:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../using-latex-in-python/">Using LaTeX In Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing-pyenv-on-a-mac/">Installing Pyenv on a Mac (A Setup Guide With Usage Tips)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conda-vs-pip/">Conda vs. Pip, Venv, and Pyenv – Simplicity Wins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jupyter-password/">Jupyter Password: Easy Notebook and Lab Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Categories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../category-c-and-cplusplus/">C and C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-jupyter/">Jupyter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-learn-to-code/">Learn to Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-math-and-math-software/">Math and Math Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-math/">Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-miscellaneous/">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-newsletter/">Newsletter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-pandas/">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-for-beginners-posts/">Python for Beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-functions/">Python Funcitons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-math-and-science/">Python Math and Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-practice/">Header</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python-tools/">Python Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../category-python/">Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../all_files/">Site Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">CodeSolid.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Creating Custom Exceptions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/images/writing-a-python-custom-exception/index.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>Many object-oriented programming languages support using and handling “built-in” exceptions and writing custom exceptions for user-defined classes and packages. Writing and raising custom exceptions in Python is very easy to do. But before you read how to do it and then go off to try it, let me set your expectations a bit differently by way of a helpful metaphor:</p>
<p>Writing custom exceptions is really easy – as easy as a two-year-old crossing the street.</p>
<p>Now that I have frightened you enough for more than one article, let me hasten to reassure you that just going off and writing some custom exceptions, even if you don’t need them, won’t get you run over. You might suffer some temporary embarrassment over a pull request. At worst, it might make your code harder to maintain than it might be otherwise.</p>
<p>Nevertheless, the point of this article is not just to point you at the street and hope for the best but to share how we might “look both ways first” to improve our code. Here’s how it will break down.</p>
<p>In part one, <strong>Creating Custom Exceptions</strong>, I will acknowledge the time-honored development practice of letting go of mom’s hand and running out in the street.</p>
<p>In the second part, <strong>Custom Exception Best Practices</strong>, I’ll share some best practices to consider. I was the developer equivalent of a two-year-old once, so in this section, I will try to write the article I needed at the time.</p>
<section id="creating-custom-exceptions">
<h1>Creating Custom Exceptions<a class="headerlink" href="#creating-custom-exceptions" title="Link to this heading">¶</a></h1>
<section id="the-custom-exception-class">
<h2>The Custom Exception Class<a class="headerlink" href="#the-custom-exception-class" title="Link to this heading">¶</a></h2>
<p>We all hate it when our favorite food goes missing, so let’s model the unfortunate case where we have run out of something.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RanOutOfSomething</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>That was too easy. We’ve written a custom exception in two lines of code, and the second line was just to let Python know that we finished declaring our <code class="docutils literal notranslate"><span class="pre">RanOutOfSomething</span></code> exception class. By the way, an alternative syntax is to use a docstring here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">RanOutOfSomething</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cupboard is bare.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Either way, the real work is done on the first line. We declare a class as a child of Python’s built-in <code class="docutils literal notranslate"><span class="pre">Exception</span></code>, and we’re done.</p>
</section>
<section id="raising-custom-exceptions">
<h2>Raising Custom Exceptions<a class="headerlink" href="#raising-custom-exceptions" title="Link to this heading">¶</a></h2>
<p>Raising (throwing) such an exception is even easier than creating them. We use the same mechanism (<code class="docutils literal notranslate"><span class="pre">raise</span></code>) as we would for a built-in exception. Here’s how that looks in Jupyter:</p>
<p><img alt="" src="../../_images/image-224.png" /></p>
</section>
<section id="further-customizing-exception-behavior-with-init">
<h2>Further Customizing Exception Behavior with __init__:<a class="headerlink" href="#further-customizing-exception-behavior-with-init" title="Link to this heading">¶</a></h2>
<p>I’m a big fan of simple exception classes like <code class="docutils literal notranslate"><span class="pre">RanOutOfSomething</span></code> that take a string because they assume that the code raising the error has the best insight into what went wrong. This idiom is common in the Python community, too. Packages that use it include NumPy and boto3.</p>
<p>To give you an idea of how you might further customize the behavior if you needed to, however, let’s write a more complex version of RanOutOfSomething, which will call NoMoreSomethingException, which will do the following:</p>
<ul class="simple">
<li><p>If called with a string, it will use the default.</p></li>
<li><p>If called with nothing, it will embarrass you. This code enforces telling the user what went wrong.</p></li>
<li><p>If called with an optional value, “what,” it will format that into a standard error message.</p></li>
</ul>
<p>I’ll warn you upfront that this code is likely about 98% more complicated than you need, but that said, here it is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NoMoreSomethingException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A flexible reminder to go to the store.</span>
<span class="sd">       </span>
<span class="sd">       Can be called with a full string or with &quot;what&quot; parameter to get a default message, e.g.</span>
<span class="sd">       </span>
<span class="sd">           NoMoreSomethingException(&quot;We&#39;re out of polar ice caps. Bring a boat.&quot;)</span>
<span class="sd">           NoMoreSomethingException(what=&quot;cheese&quot;)                  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">what</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">what</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;We&#39;re out of </span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An inconsiderate colleague ran out of something.  Go look in the source; he hates you.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">message</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NoMoreSomethingException</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>To test this out, we don’t necessarily have to raise the error. Since exceptions are just classes, we can see how they will appear by using <code class="docutils literal notranslate"><span class="pre">print</span></code> along with the <code class="docutils literal notranslate"><span class="pre">repr</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex1</span> <span class="o">=</span> <span class="n">NoMoreSomethingException</span><span class="p">(</span><span class="s2">&quot;We&#39;re out of coffee! Development work cannot continue!!!&quot;</span><span class="p">)</span>
<span class="n">ex2</span> <span class="o">=</span> <span class="n">NoMoreSomethingException</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;apple juice&quot;</span><span class="p">,</span> <span class="s2">&quot;Pop Tarts&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ex1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ex2</span><span class="p">))</span>

<span class="c1"># Don&#39;t do this:</span>
<span class="n">bad</span> <span class="o">=</span> <span class="n">NoMoreSomethingException</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">bad</span><span class="p">))</span>


<span class="c1">## OUTPUTS</span>

<span class="n">NoMoreSomethingException</span><span class="p">(</span><span class="s2">&quot;We&#39;re out of coffee! Development work cannot continue!!!&quot;</span><span class="p">)</span>
<span class="n">NoMoreSomethingException</span><span class="p">(</span><span class="s2">&quot;We&#39;re out of [&#39;apple juice&#39;, &#39;Pop Tarts&#39;].&quot;</span><span class="p">)</span>
<span class="n">NoMoreSomethingException</span><span class="p">(</span><span class="s1">&#39;An inconsiderate colleague ran out of something and is making you read the source to find out what it is.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By the way, if you still need to hide the government secret of what we ran out of, <code class="docutils literal notranslate"><span class="pre">NoMoreSomethingException(&quot;&quot;)</span></code> gets you there.</p>
<p>Of course, you can do many other customizations, for example, <a class="reference external" href="https://codesolid.com/dunder-methods-in-python-the-ugliest-awesome-sauce/">overriding dunder methods</a> or supporting the numerical error codes that some downstream system returns. However, the clarity of the exception name and a customizable message string is often 99% of what you need.</p>
<p>With that said, you now know where the street is. In our next section, let’s discuss how we can look both ways before crossing.</p>
</section>
</section>
<section id="python-custom-exception-best-practices">
<h1>Python Custom Exception Best Practices<a class="headerlink" href="#python-custom-exception-best-practices" title="Link to this heading">¶</a></h1>
<p>In this section, we want to discuss three things you should consider before implementing custom exception classes in Python.</p>
<ul class="simple">
<li><p>Understanding the existing exception hierarchy in Python and where custom exceptions fit in.</p></li>
<li><p>Deciding if we even need custom exceptions, or whether we can use the built-in exception classes.</p></li>
<li><p>Thinking about additional design considerations if we are using custom exceptions.</p></li>
</ul>
<section id="user-defined-exceptions-vs-built-in-exceptions">
<h2>User Defined Exceptions vs. Built-In Exceptions<a class="headerlink" href="#user-defined-exceptions-vs-built-in-exceptions" title="Link to this heading">¶</a></h2>
<p>As we’ve seen above, when we create user-defined exceptions in Python, we derive our custom class from Exception, not from BaseException. The informal class diagram below gives an overview of how the different classes fit together.</p>
<p><img alt="" src="../../_images/CustomException.drawio-2.png" /></p>
<p>The Python documentation advises that custom exceptions should derive from Exception, not BaseException. To give you an idea of why this is so, consider two of the other classes derived from BaseException: SystemExit and KeyboardInterrupt. As the names imply, these are very low-level classes that we might handle, but generally wouldn’t need to override.</p>
<p>As we show here, the Exception class is a bit of a chameleon. It forms the basis of several important built-in classes on the one hand, and on the other, it is the right place to begin to define our user-defined exception classes.</p>
<p>On the built-in exception side on the left, many classes in Python derive from OSError. Moreover, several earlier classes have been reworked as aliases of OSError as of Python 3.3. For example, in newer versions of Python <code class="docutils literal notranslate"><span class="pre">IOError</span> <span class="pre">==</span> <span class="pre">OSError</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>! There are other classes here as well, however. Here is a more complete <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#exception-hierarchy">hierarchy chart</a> for the built-in exceptions.</p>
<p>On the right-hand side of the chart image above, we show a possible user-defined class hierarchy. As shown here, this could be done as a common base class at the root with other classes derived from it. We’ll discuss this in a later section on class design. Before we discuss what the design should be, however, let’s first discuss the issue of whether you even need to design anything at all.</p>
</section>
</section>
<section id="yagni-you-ain-t-gonna-need-it">
<h1>YAGNI: You Ain’t Gonna Need It<a class="headerlink" href="#yagni-you-ain-t-gonna-need-it" title="Link to this heading">¶</a></h1>
<p>I think the best question you can ask yourself to decide if you really need one or more custom exceptions in your code is this one: Am I writing an application or a library?</p>
<p>If you’re writing a library, then there’s a very good chance that custom exception classes make sense. You want your users to be able to distinguish between an error in using your library and an error taking place somewhere else.</p>
<p>However, for every library developer, there are dozens if not hundreds of end users who are developing Python applications, doing data analytics, working in DevOps – or doing any number of other useful things with Python. If this is you, it’s quite possible that you can get by on a small number of built-in exceptions plus whatever the exceptions defined in whatever libraries you might be using.</p>
<p>For example, the best practice of checking function inputs can often be handled with two built-in exceptions. A TypeError can be used to remind the user of the correct type if they pass the wrong one to a function, while a ValueError can be raised if the type is correct but the value is out of range or can’t be supported – for example, a two-digit month that’s less than one or greater than twelve. To document that your code has encountered some other condition that you thought would never, ever in a zillion years happen (but of course does the day after you ship, lucky you), a simple Exception is sufficient. If you’re going to be working seriously in Python, it’s worth a few minutes of your time to read through the documentation on the <a class="reference external" href="https://docs.python.org/3/library/exceptions.html">Python exception classes</a> so you understand what’s available.</p>
<p>Of course, even within an application, it’s possible you may want to define a very small number of custom exceptions to mark errors that occurred at a certain layer. For example, you may want to distinguish errors taking place in the model from those happening in the controller. However, if you’ve structured your code well, the stack trace should provide that same information without resorting to custom exception classes.</p>
<section id="design-decisions">
<h2>Design Decisions<a class="headerlink" href="#design-decisions" title="Link to this heading">¶</a></h2>
<p>We’ve been discussing aspects of exception design all along. We generally want a simple override unless we need further customization such as reporting an underlying error. This is common practice in HTTP libraries for example, where we might want the string response “Not Found” and the appropriate HTTP status code, 404.</p>
<p>The only final thing to consider, then, is the issue of having a single root exception class or not for your library. Different libraries take different approaches to this. The Pandas library derives each custom exception directly from Python’s <code class="docutils literal notranslate"><span class="pre">Exception</span></code> class, in an ad-hoc fashion, for example.</p>
<p>Since I haven’t seen too many notebooks that wrap their Pandas code in try/except blocks, that’s probably not a big problem. The more commonly scripted client library for Amazon Web Services, boto3, takes the alternative approach of having a common root exception, <code class="docutils literal notranslate"><span class="pre">Boto3Error</span></code>, from which all other exceptions are derived. This makes it easy to add error handling any time you make a call, which I think works really well for a client library like this.</p>
</section>
</section>
<section id="closing-thoughts">
<h1>Closing Thoughts<a class="headerlink" href="#closing-thoughts" title="Link to this heading">¶</a></h1>
<p>Software developers love grand designs and framework development because sometimes that can be a lot more interesting than the day-to-day grunt work of shipping products. Python custom exceptions are easy to add, but chances are we don’t need them if we’re working on an application. If that’s the case, the best thing we can do for our users is to use well-known exceptions together with an error string providing detailed information about how to resolve the issue.</p>
<p>The true gold standard here is not whether we can cleverly override a Python constructor, but whether someone who is the unfortunate exception of a late-night support call can read the exception message and have a reasonable chance of being able to address the issue and go back to sleep.</p>
<p>I realize I’m on a bit of a soapbox here.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">FellOffSoapBoxError</span><span class="p">(</span><span class="s2">&quot;Thanks for reading!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, John Lockwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QX7KGT4YPE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QX7KGT4YPE', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>